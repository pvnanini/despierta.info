"use strict";!function(e,t){let s=t.modules.controls.Select.extend({onReady:function(){let e=this.$el;0!=e.find("[data-setting=crel_Generic__Custom_Presets]").length&&this.updateCustomSelect(e)},onRender:function(){this.constructor.__super__.onRender.apply(this,arguments),this.addResetButton()},ui:function(){let e=this.constructor.__super__.ui.call(this);return e.save_preset_button=".crel-button-save_new-preset",e.update_preset_button=".crel-button-update-preset",e.update_preset=".crel-update-preset-button",e.cancel_update_preset=".crel-cancel-update-preset-button",e.delete_preset=".crel-delete-preset-button",e.pre_delete_preset=".crel-pre-delete-preset-button",e.cancel_delete_preset=".crel-cancel-delete-preset-button",e.create_preset=".crel-create-preset-button",e.cancel_preset=".crel-cancel-preset-button",e},events:function(){let e=this.constructor.__super__.events.call(this);return e["click @ui.save_preset_button"]="onOpenSave",e["click @ui.update_preset_button"]="onOpenUpdate",e["click @ui.update_preset"]="onUpdatePreset",e["click @ui.cancel_update_preset"]="onCancelPreset",e["click @ui.delete_preset"]="onDeletePreset",e["click @ui.pre_delete_preset"]="onPreDeletePreset",e["click @ui.cancel_delete_preset"]="onCancelDeletePreset",e["click @ui.create_preset"]="onCreatePreset",e["click @ui.cancel_preset"]="onCancelPreset",e},addResetButton:function(){let s=this;e("body").off("click",".crel-reset-design"),e("body").on("click",".crel-reset-design",function(){let n=t.getPanelView().getCurrentPageView().getOption("editedElementView");$e.run("document/elements/reset-style",{container:n.getContainer()}),e("[class*=crel_Generic__Presets] select").val(""),s.setSettingsModel("")})},onBaseInputChange:function(t){let s=e(t.currentTarget),n=s.closest(".elementor-control"),r=s.val(),l={};if(s.find("option").each(function(){e(this).val()==r&&(l=e(this).data("value"))&&"string"==typeof l&&(l=JSON.parse(l))}),void 0===l&&void 0!==creative_preset_vars.custom_presets[r]&&(l=creative_preset_vars.custom_presets[r].options),void 0===l||!l)return;r&&n.find(".crel-button-update-preset").length&&(n.find(".crel-button-update-preset").show(),n.find(".crel-new-preset-name").hide());let o=this.getElementSettingsModel().controls,i=this,a={},c=i.model.get("name");a[s.data("setting")]=r,e.each(o,function(t,s){if(c!==t&&void 0!==l[t])if(s.is_repeater){let s=i.getElementSettingsModel().get(t).clone();s.each(function(n,r){void 0!==l[t][r]&&e.each(n.controls,function(e,n){i.isStyleTransferControl(n)&&void 0!==l[t][r][e]&&s.at(r).set(e,l[t][r][e])})}),a[t]=s}else i.isStyleTransferControl(s)&&(a[t]=l[t])}),$e.run("document/elements/settings",{container:this.container,settings:a,options:{external:!0,render:!1}}),$e.run("document/globals/settings",{container:this.container,settings:{},options:{external:!0,render:!1}}),void 0!==l.__globals__&&$e.run("document/globals/settings",{container:this.container,settings:l.__globals__,options:{external:!0,render:!1}}),this.container.render(),$e.components.get("document/save").footerSaver.activateSaveButtons(document,!0)},getElementSettingsModel:function(){return this.container.settings},isStyleTransferControl:function(e){return void 0!==e&&e.style_transfer?e.style_transfer:"content"!==e.tab||e.selectors||e.prefix_class||e.force_preset},onCreatePreset:function(t){let s=e(t.target);s.hasClass("elementor-button")||(s=s.closest(".elementor-button"));let n=s.closest(".elementor-control-field"),r=n.find(".crel-create_preset-name"),l=n.find("select"),o=this,i=n.find(".crel-update-preset-message"),a=this.getElementSettingsModel().attributes.widgetType;if(!r.val())return r.addClass("crel-new-preset-name--error"),void setTimeout(function(){r.removeClass("crel-new-preset-name--error")},2e3);let c=this.getSettings(),p={action:"crel-update-preset",crel_nonce:creative_preset_vars.nonce,options:c,preset_name:r.val(),widget_type:a,preset_id:""};e.ajax({type:"POST",dataType:"json",url:creative_preset_vars.ajax_url,data:p,beforeSend:function(e){s.find(".crel-button-state-icon").show(),s.find(".crel-button-label").hide(),i.html("")}}).done(function(e){"success"==e.status?(i.html(`<div class="crel-update-preset-message--success">${e.message}</div>`),setTimeout(function(){i.html("")},2e3),creative_preset_vars.custom_presets[e.id]=e.preset,o.updateCustomSelect(n),l.val(e.id),l.trigger("change"),setTimeout(function(){n.find(".crel-panel-popup--save_preset").hide(),i.html("")},2e3)):n.find(".crel-update-preset-message").html(`<div class="crel-update-preset-message--error">${e.message}</div>`)}).always(function(){s.find(".crel-button-state-icon").hide(),s.find(".crel-button-label").show()})},getNotDefaultOptions:function(){let e={},t=this.getElementSettingsModel().attributes,s=this.getElementSettingsModel().defaults;for(let n in t)t[n]!=s[n]&&(e[n]=t[n]);return e},onUpdatePreset:function(t){let s=e(t.target);s.hasClass("elementor-button")||(s=s.closest(".elementor-button"));let n=s.closest(".elementor-control-field"),r=n.find("select"),l=this,o=n.find(".crel-update-preset-message"),i=r.val(),a=n.find(".crel-update_preset-name"),c=this.getElementSettingsModel().attributes.widgetType;if(!a.val())return a.addClass("crel-new-preset-name--error"),void setTimeout(function(){a.removeClass("crel-new-preset-name--error")},2e3);let p=this.getSettings(),d={action:"crel-update-preset",crel_nonce:creative_preset_vars.nonce,options:0==n.find(".crel-update_preset-confirm:checked").length?"":p,preset_name:a.val(),widget_type:c,preset_id:i};e.ajax({type:"POST",dataType:"json",url:creative_preset_vars.ajax_url,data:d,beforeSend:function(e){s.find(".crel-button-state-icon").show(),s.find(".crel-button-label").hide(),o.html("")}}).done(function(e){"success"==e.status?(o.html(`<div class="crel-update-preset-message--success">${e.message}</div>`),setTimeout(function(){n.find(".crel-panel-popup--update_preset").hide(),o.html("")},2e3),n.find(".crel-update_preset-confirm:checked").length&&d.options&&(creative_preset_vars.custom_presets[i].options=JSON.parse(d.options),r.trigger("change")),creative_preset_vars.custom_presets[i].title=e.new_name,l.updateCustomSelect(n)):n.find(".crel-update-preset-message").html(`<div class="crel-update-preset-message--error">${e.message}</div>`)}).always(function(){s.find(".crel-button-state-icon").hide(),s.find(".crel-button-label").show()})},onDeletePreset:function(t){let s=e(t.target);s.hasClass("elementor-button")||(s=s.closest(".elementor-button"));let n=s.closest(".elementor-control-field"),r=n.find("select"),l=this,o=n.find(".crel-update-preset-message"),i=r.val(),a="";r.find("option").each(function(){e(this).val()==i&&(a=e(this).text())});let c={action:"crel-delete-preset",crel_nonce:creative_preset_vars.nonce,preset_id:i};e.ajax({type:"POST",dataType:"json",url:creative_preset_vars.ajax_url,data:c,beforeSend:function(e){s.find(".crel-button-state-icon").show(),s.find(".crel-button-label").hide(),o.html("")}}).done(function(e){"success"==e.status?(o.html(`<div class="crel-update-preset-message--success">${e.message}</div>`),setTimeout(function(){n.find(".crel-panel-popup--update_preset").hide(),n.find(".crel-panel-popup--update_preset_2").hide(),n.find(".crel-panel-popup--update_preset_1").show(),o.html(""),delete creative_preset_vars.custom_presets[i],l.updateCustomSelect(n),r.val(""),r.trigger("change")},2e3)):n.find(".crel-update-preset-message").html(`<div class="crel-update-preset-message--error">${e.message}</div>`)}).always(function(){s.find(".crel-button-state-icon").hide(),s.find(".crel-button-label").show()})},updateCustomSelect:function(t){let s=t.find("[data-setting=crel_Generic__Custom_Presets]"),n=this.getElementSettingsModel().attributes.crel_Generic__Custom_Presets,r=this.getElementSettingsModel().attributes.widgetType,l=!1;s.html(`<option value="" selected>${creative_preset_vars.select_preset_title}</option>`);for(let e in creative_preset_vars.custom_presets)creative_preset_vars.custom_presets[e].widget_type==r&&(s.append(`<option value="${e}">${creative_preset_vars.custom_presets[e].title}</option>`),l=!0);let o=s.find("option");o.sort(function(t,s){return e(t).text().localeCompare(e(s).text(),"standard",{numeric:!0})}),s.html("").append(o),s.val(n),l?s.closest(".elementor-control").removeClass("crel-preset-wrap-empty"):s.closest(".elementor-control").addClass("crel-preset-wrap-empty")},getSettings:function(){let e=Object.assign({},this.getElementSettingsModel().attributes);for(let t in e)~creative_preset_vars.excluded_options.indexOf(t)&&delete e[t];return JSON.stringify(e)},onOpenUpdate:function(t){let s=e(t.target);s.hasClass("elementor-button")||(s=s.closest(".elementor-button"));let n=s.closest(".elementor-control"),r=n.find("select"),l=r.val();return n.find(".crel-update_preset-confirm").prop("checked",!1),l?(n.find(".crel-update_preset-name").val(r.find("option[value="+l+"]").text()),n.find(".crel-update-preset-message").html(""),n.find(".crel-panel-popup--save_preset").hide(),n.find(".crel-panel-popup--update_preset").show(),!1):(r.addClass("crel-new-preset-name--error"),void setTimeout(function(){r.removeClass("crel-new-preset-name--error")},2e3))},onOpenSave:function(t){let s=e(t.target);s.hasClass("elementor-button")||(s=s.closest(".elementor-button"));let n=s.closest(".elementor-control");return n.find("select").val(""),n.find(".crel-create_preset-name").val(""),setTimeout(function(){n.find(".crel-create_preset-name").get(0).focus()},100),n.find(".crel-update-preset-message").html(""),n.find(".crel-panel-popup--update_preset").hide(),n.find(".crel-panel-popup--save_preset").show(),!1},onCancelPreset:function(t){let s=e(t.target);return s.hasClass("elementor-button")||(s=s.closest(".elementor-button")),s.closest(".crel-panel-popup").hide(),!1},onPreDeletePreset:function(t){let s=e(t.target);s.hasClass("elementor-button")||(s=s.closest(".elementor-button"));let n=s.closest(".elementor-control-field");return n.find(".crel-panel-popup--update_preset_1").hide(),n.find(".crel-panel-popup--update_preset_2").show(),!1},onCancelDeletePreset:function(t){let s=e(t.target);s.hasClass("elementor-button")||(s=s.closest(".elementor-button"));let n=s.closest(".elementor-control-field");return n.find(".crel-panel-popup--update_preset_2").hide(),n.find(".crel-panel-popup--update_preset_1").show(),!1}});t.addControlView("creative_preset",s)}(window.jQuery,window.elementor),jQuery(document).ready(function(e){function t(t){let s=!1,n=t.val();if(t.find("option").each(function(){e(this).val()==n&&(s=e(this))}),!s)return!0;s.closest("#elementor-controls").find(".crel-preset-v2__select.color").each(function(){if("flex"!==e(this).css("display"))return!0;let t=!1;e(this).find("option").each(function(){if(s.data("colors")&&e(this).val()&&!~s.data("colors").indexOf(e(this).val()))e(this).hide();else if(e(this).show(),!t){t=!0;let s=e(this).closest("select");s.val(e(this).val()),setTimeout(function(){s.trigger("change")},50)}})})}e(document).on("change","[data-setting=crel_presets_v2_general]",function(){let s=e(this).closest("#elementor-controls"),n=e(this);s.find(".crel-preset-v2__select").each(function(){e(this).find("select").val(""),n.val()&&e(this).hasClass(n.val())?(e(this).css({display:"flex"}),e(this).find("select").val(e(this).find("option").eq(0).val()),e(this).find("select").trigger("change"),e(this).hasClass("style")&&t(e(this).find("select"))):e(this).css({display:"none"})})}),e(document).on("change",".crel-preset-v2__select.style select",function(){t(e(this))})});