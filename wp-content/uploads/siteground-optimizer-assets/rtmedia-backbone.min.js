var nextpage=2,upload_sync=!1,activity_id=-1,rtmedia_load_template_flag=!0,rtmedia_add_media_button_post_update=!1,objUploadView,galleryObj,uploaderObj,commentObj,plupload_comment_main,comment_media_wrapper,rtmedia_comment_media_submit,comment_media_add_button,comment_media_uplaod_media;jQuery(document).ready(function(){var a;if('object'==typeof rtmedia_backbone)for(a in rtmedia_backbone)window[a]=rtmedia_backbone[a];if('object'==typeof rtMedia_plupload)for(a in rtMedia_plupload)window[a]=rtMedia_plupload[a];if('object'==typeof rtmedia_template)for(a in rtmedia_template)window[a]=rtmedia_template[a];if('object'==typeof rtMedia_activity)for(a in rtMedia_activity)window[a]=rtMedia_activity[a];if('object'==typeof rtmedia_bp)for(a in rtmedia_bp)window[a]=rtmedia_bp[a];if('object'==typeof rtmedia_main)for(a in rtmedia_main)window[a]=rtmedia_main[a]}),jQuery(function(a){var c,d,f,b,e;a(document).ready(function(){a('#activity-stream').on('click','.acomment-delete',function(){let b=a(this).closest('li').find('div.acomment-content ul.rtmedia-list');b.length>0&&b.remove()}),a('#rtmedia_media_single_edit .rtm-button-save').on('click',function(){var b=a('#rtmedia-editor-media-id').val(),c=a('#rtmedia-editor-nonce').val();if('undefined'==typeof c||''===c.trim()||'undefined'==typeof b||''===b.trim())return;if(b=parseInt(b),$media_head=a('#media-head-'+b),!$media_head.length||'undefined'==typeof $media_head.css('display')||'none'!==$media_head.css('display').trim())return;imageEdit.save(b,c)});function b(){location.reload()}a.ajaxPrefilter(function(d,c,e){try{if(null===c.data||typeof c.data=='undefined'||typeof c.data.action=='undefined'||'buddypress-edit-activity-save'!==c.data.action)return!0}catch(a){return!0}if(!a('#activity-'+c.data.activity_id).hasClass('rtmedia_update'))return;c.success=b,d.success=b})}),typeof is_album=='undefined'?c=new Array(''):c=is_album,typeof is_edit_allowed=='undefined'?d=new Array(''):d=is_edit_allowed,rtMedia=window.rtMedia||{},rtMedia=window.rtMedia||{},rtMedia.Context=Backbone.Model.extend({url:function(){var a=rtmedia_media_slug+'/';return!upload_sync&&nextpage>0&&(a+='pg/'+nextpage+'/'),a},defaults:{context:'post',context_id:!1}}),rtMedia.Media=Backbone.Model.extend({defaults:{id:0,blog_id:!1,media_id:!1,media_author:!1,media_title:!1,album_id:!1,media_type:'photo',activity_id:!1,privacy:0,views:0,downloads:0,ratings_average:0,ratings_total:0,ratings_count:0,likes:0,dislikes:0,guid:!1,width:0,height:0,rt_permalink:!1,duration:'0:00'}}),rtMedia.Gallery=Backbone.Collection.extend({model:rtMedia.Media,url:function(){var b=window.location.pathname,a='';return b.indexOf('/'+rtmedia_media_slug+'/')==-1?a=rtmedia_media_slug+'/':b.indexOf('pg/')==-1?a=b:a=window.location.pathname.substr(0,window.location.pathname.lastIndexOf('pg/')),!upload_sync&&nextpage>=1&&(a.substr(a.length-1)!='/'&&(a+='/'),a+='pg/'+nextpage+'/'),a},getNext:function(j,b,f){var i,e,h,g;jQuery('.rtmedia-no-media-found').length>0&&(i=jQuery('<ul/>',{class:'rtmedia-list rtmedia-list-media rtm-pro-allow-action'}),jQuery('.rtmedia-no-media-found').replaceWith(i)),that=this,rtmedia_load_template_flag==!0&&(jQuery('.rtmedia_gallery_wrapper').find('input[name=media_title]').length>0&&(template_url+='&media_title='+jQuery('.rtmedia_gallery_wrapper').find('input[name=media_title]').val()),jQuery('.rtmedia_gallery_wrapper').find('input[name=lightbox]').length>0&&(template_url+='&lightbox='+jQuery('.rtmedia_gallery_wrapper').find('input[name=lightbox]').val()),a('#rtmedia-gallery-item-template').load(template_url,{backbone:!0,is_album:c,is_edit_allowed:d},function(){rtmedia_load_template_flag=!1,that.getNext(j,b,f)})),rtmedia_load_template_flag||(e={json:!0},check_condition('search')&&''!==a('#media_search_input').val()&&(h=check_url('search'),h&&(e.search=h),check_condition('search_by')&&(g=check_url('search_by'),g&&(e.search_by=g))),e.rtmedia_page=nextpage,b==void 0&&(b=jQuery('.rtmedia-list').parent().parent()),b!=void 0&&(f!=void 0&&a(f).parent().parent().prevAll('input[type=hidden]').not('input[name=_wp_http_referer], input[name=rtmedia_media_delete_nonce], input[name=rtmedia_bulk_delete_nonce], input[name=bulk-action], input[name=rtmedia_create_album_nonce], input[name=rtmedia_media_nonce], input[name=rtmedia_upload_nonce], input[name=rtmedia_allow_upload_attribute]').each(function(b){a(this).attr('name')&&(e[a(this).attr('name')]=a(this).val())}),a(b).find('input[type=hidden]').not('input[name=_wp_http_referer], input[name=rtmedia_media_delete_nonce], input[name=rtmedia_bulk_delete_nonce], input[name=bulk-action], input[name=rtmedia_create_album_nonce], input[name=rtmedia_media_nonce], input[name=rtmedia_upload_nonce], input[name=rtmedia_allow_upload_attribute]').each(function(b){a(this).attr('name')&&(e[a(this).attr('name')]=a(this).val())})),this.fetch({data:e,success:function(i,c){var e,g,h,d;jQuery('.rtm-media-loading').hide(),e='',typeof f=='undefined'?jQuery(b).find('.rtmedia-list').length>0?e=jQuery(b).find('.rtmedia-list'):e=a('.rtmedia-list')[0]:e=f.parent().siblings('.rtmedia-list'),nextpage=c.next,nextpage<1&&typeof b=='object'&&jQuery(b).find('.rtmedia_next_prev').children('#rtMedia-galary-next').hide(),rtMedia.gallery={},rtMedia.gallery.page=j,g=new rtMedia.GalleryView({collection:new rtMedia.Gallery(c.data),el:e}),h=g.$el.parents('.rtmedia-container'),d=h.attr('id'),rtMediaHook.call('rtmedia_after_gallery_load'),jQuery('#'+d+' .rtmedia_next_prev .rtm-pagination').remove(),jQuery('#'+d+' .rtmedia_next_prev .clear').remove(),jQuery('#'+d+' .rtmedia_next_prev .rtm-media-loading').remove(),jQuery('#'+d+' .rtmedia_next_prev br').remove(),jQuery('#'+d+' .rtmedia_next_prev').append(c.pagination),jQuery('#user-media span, #media-groups-li #media span, #rtmedia-nav-item-all span').text(c.media_count.all_media_count),jQuery('#rtmedia-nav-item-photo span').text(c.media_count.photos_count),jQuery('#rtmedia-nav-item-music span').text(c.media_count.music_count),jQuery('#rtmedia-nav-item-video span').text(c.media_count.videos_count),jQuery('li#rtm-url-upload').length===0&&(jQuery('#'+d+' .rtmedia-list').css({opacity:1,height:'auto',overflow:'auto'}),rtMediaHook.call('rtmedia_js_uploader_slide_after_gallery_reload')&&jQuery('#rtm-media-gallery-uploader').slideUp())}}))},reloadView:function(a){upload_sync=!0,nextpage=1,jQuery('.rtmedia-container .rtmedia-list').css('opacity','0.5'),this.getNext(void 0,a,void 0)}}),rtMedia.MediaView=Backbone.View.extend({tagName:'li',className:'rtmedia-list-item',initialize:function(){this.template=_.template(a('#rtmedia-gallery-item-template').html()),this.model.bind('change',this.render),this.model.bind('remove',this.unrender),this.render()},render:function(){return a(this.el).html(this.template(this.model.toJSON())),this.el},unrender:function(){a(this.el).remove()},remove:function(){this.model.destroy()}}),rtMedia.GalleryView=Backbone.View.extend({tagName:'ul',className:'rtmedia-list',initialize:function(){this.template=_.template(a('#rtmedia-gallery-item-template').html()),this.render()},render:function(){that=this;var b=a('div[id^="rtmedia_gallery_container_"] .rtmedia-nodata');upload_sync&&a(that.el).html(''),(typeof rtmedia_load_more_or_pagination!='undefined'&&rtmedia_load_more_or_pagination=='pagination'||1==rtMedia.gallery.page)&&a(that.el).html(''),b.length>0&&b.remove(),0===this.collection.length?a('div[id^="rtmedia_gallery_container_"]').append('<p class="rtmedia-nodata">'+rtmedia_no_media_found+'</p>'):a.each(this.collection.toJSON(),function(c,b){a(that.el).append(that.template(b))}),upload_sync&&(upload_sync=!1),nextpage>1&&a(that.el).siblings('.rtmedia_next_prev').children('#rtMedia-galary-next').show(),'undefined'!=typeof rtmedia_masonry_layout&&'true'==rtmedia_masonry_layout&&0==jQuery('.rtmedia-container .rtmedia-list.rtm-no-masonry').length&&rtm_masonry_reload(rtm_masonry_container),a('#media_fatch_loader').removeClass('load')},appendTo:function(b){var c=new rtMedia.MediaView({model:b});a(this.el).append(c.render().el)}}),galleryObj=new rtMedia.Gallery,a('body').append('<script id="rtmedia-gallery-item-template" type="text/template"><\/script>'),a(document).on('click','#rtMedia-galary-next',function(b){jQuery('.rtm-media-loading').length==0?a(this).before("<div class='rtm-media-loading'><img src='"+rMedia_loading_media+"' /></div>"):jQuery('.rtm-media-loading').show(),a(this).hide(),b.preventDefault();var c=a(this).closest('.rtmedia-container').parent();galleryObj.getNext(nextpage,c,a(this))}),a(document).on('click','#rtmedia_show_all_comment',function(){var b=a('#rtmedia_show_all_comment').parent().next();a(b).each(function(){a(this).find('li').each(function(){a(this).removeClass('hide')})}),a(this).parent().remove(),rtMediaScrollComments()}),a(document).on('keypress','#rtmedia_go_to_num',function(c){var d,b,e,f;if(c.keyCode==13)return c.preventDefault(),d=a(this).parents('.rtmedia-container'),b=d.attr('id'),a('#'+b+' .rtm-media-loading').length==0?a('#'+b+' .rtm-pagination').before("<div class='rtm-media-loading'><img src='"+rMedia_loading_media+"' /></div>"):a('#'+b+' .rtm-media-loading').show(),parseInt(a('#'+b+' #rtmedia_go_to_num').val())>parseInt(a('#'+b+' #rtmedia_last_page').val())?nextpage=parseInt(a('#'+b+' #rtmedia_last_page').val()):nextpage=parseInt(a('#'+b+' #rtmedia_go_to_num').val()),e=a('#'+b+' .rtmedia-page-no .rtmedia-page-link').data('page-base-url'),f=e+nextpage,change_rtBrowserAddressUrl(f,''),galleryObj.getNext(nextpage,a(this).parents('.rtmedia_gallery_wrapper'),a(this).parents('.rtm-pagination')),!1}),a(document).on('click','.rtmedia-page-link',function(g){var d,b,c,e,f;href=a(this).attr('href'),d=a(this).parents('.rtmedia-container'),b=d.attr('id'),a('#'+b+' .rtm-media-loading').length==0?a('#'+b+' .rtm-pagination').before("<div class='rtm-media-loading'><img src='"+rMedia_loading_media+"' /></div>"):a('#'+b+' .rtm-media-loading').show(),g.preventDefault(),a(this).data('page-type')=='page'?nextpage=a(this).data('page'):a(this).data('page-type')=='prev'?nextpage==-1?nextpage=parseInt(a('#'+b+' #rtmedia_last_page').val())-1:nextpage-=2:a(this).data('page-type')=='num'&&(parseInt(a('#'+b+' #rtmedia_go_to_num').val())>parseInt(a('#rtmedia_last_page').val())?nextpage=parseInt(a('#'+b+' #rtmedia_last_page').val()):nextpage=parseInt(a('#'+b+' #rtmedia_go_to_num').val()),page_base_url=a(this).data('page-base-url'),href=page_base_url+nextpage),c=a('#media_search_input'),check_condition('search')&&c.length>0&&''!==c.val()&&(e=check_url('search'),href+='?search='+e,check_condition('search_by')&&(f=check_url('search_by'),href+='&search_by='+f)),change_rtBrowserAddressUrl(href,''),galleryObj.getNext(nextpage,a(this).closest('.rtmedia-container').parent(),a(this).closest('.rtm-pagination'))}),a(document).on('submit','form#media_search_form',function(g){var d,e,f,c,b;if(g.preventDefault(),d=a('#media_search_input').val(),e=a('#media_search'),f=a('#media_fatch_loader'),c=a('input[type="hidden"][name="media_type"]'),''===d)return!1;e.css('cursor','pointer'),f.addClass('load'),nextpage=1,b=window.location.href,b.indexOf('?')>-1&&(b=window.location.pathname),b+='?search='+d,a('#search_by').length>0&&(b+='&search_by='+a('#search_by').val()),c.length>0&&'album'===c.val()&&(b+='&media_type='+c.val()),b=encodeURI(b),change_rtBrowserAddressUrl(b,''),galleryObj.getNext(nextpage,a(this).closest('.rtmedia-container').parent()),a('#media_search_remove').show()}),a(document).on('click','#media_search_remove',function(c){a('#media_search').css('cursor','not-allowed'),a('#media_fatch_loader').addClass('load'),jQuery('#media_search_input').val(''),nextpage=1;var b=window.location.pathname;check_condition('/pg')&&(remove_index=b.indexOf('pg'),remove_href=b.substring(remove_index),b=b.replace(remove_href,'')),change_rtBrowserAddressUrl(b,''),galleryObj.getNext(nextpage,a(this).parent().parent().parent().parent().parent()),a('#media_search_remove').hide()}),window.location.pathname.indexOf(rtmedia_media_slug)!=-1&&(f=window.location.pathname.substring(window.location.pathname.lastIndexOf('pg/')+5,window.location.pathname.lastIndexOf('/')),isNaN(f)===!1&&(nextpage=parseInt(f)+1)),window.UploadView=Backbone.View.extend({events:{'click #rtMedia-start-upload':'uploadFiles'},initialize:function(a){this.uploader=new plupload.Uploader(a);var b=a.filters[0].extensions.length;b===0&&this.uploader.bind('Browse',function(a){rtmedia_gallery_action_alert_message(rtmedia_media_disabled_error_message,'warning')})},render:function(){},initUploader:function(b){if(typeof b!='undefined'&&(b=!1),this.uploader.init(),a('.plupload.html5').css({zIndex:0}),a('#rtMedia-upload-button').css({zIndex:2}),b!==!1){window.file_size_info=rtmedia_max_file_msg+this.uploader.settings.max_file_size_msg,rtmedia_version_compare(rtm_wp_version,'3.9')?file_extn=this.uploader.settings.filters.mime_types[0].extensions:file_extn=this.uploader.settings.filters[0].extensions,window.file_extn_info=rtmedia_allowed_file_formats+' : '+file_extn.split(',').join(', ');var c=window.file_size_info+'\n'+window.file_extn_info;a('.rtm-file-size-limit').attr('title',c)}return this},uploadFiles:function(a){return a!=void 0&&a.preventDefault(),this.uploader.start(),!1}}),a('#rtMedia-upload-button').length>0?(typeof rtmedia_upload_type_filter=='object'&&rtmedia_upload_type_filter.length>0&&(rtMedia_plupload_config.filters[0].extensions=rtmedia_upload_type_filter.join()),uploaderObj=new UploadView(rtMedia_plupload_config),uploaderObj.initUploader(),b='',e=!1,jQuery(document).ajaxComplete(function(){e&&(e=!1,window.location=b.redirect_url)}),uploaderObj.uploader.bind('UploadComplete',function(f,g){var d,c;activity_id=-1,d=rtMediaHook.call('rtmedia_js_after_files_uploaded'),typeof rtmedia_gallery_reload_on_upload!='undefined'&&rtmedia_gallery_reload_on_upload=='1'&&d!=!1&&galleryObj.reloadView(),jQuery('#rtmedia_uploader_filelist li.plupload_queue_li').remove(),jQuery('.start-media-upload').hide(),apply_rtMagnificPopup(jQuery('.rtmedia-list-media, .rtmedia-activity-container ul.rtmedia-list, #bp-media-list,.widget-item-listing,.bp-media-sc-list, li.media.album_updated ul,ul.bp-media-list-media, li.activity-item div.activity-content div.activity-inner div.bp_media_content')),c=a('#rt_upload_hf_redirect'),''!==b&&'undefined'!=typeof b.redirect_url&&null!==b.redirect_url&&uploaderObj.upload_count===f.files.length&&0<c.length&&'true'===c.val()&&0===b.redirect_url.indexOf('http')&&(e=!0),window.onbeforeunload=null}),uploaderObj.uploader.bind('FilesAdded',function(b,e){var j=!1,h='',i='',d=[],g=jQuery('.rtmedia-upload-input'),c=jQuery('.start-media-upload'),f;if(a.each(e,function(k,e){var j,f,i,h;if(rtm_file_name_array=e.name.split('.'),e.title=rtm_file_name_array[0],j=rtMediaHook.call('rtmedia_js_file_added',[b,e,'#rtmedia_uploader_filelist']),j==!1)return e.status=-1,d.push(e.id),!0;if(g.attr('value',rtmedia_add_more_files_msg),typeof rtmedia_direct_upload_enabled!='undefined'&&rtmedia_direct_upload_enabled=='1'?c.hide():c.show(),uploaderObj.uploader.settings.max_file_size<e.size)return!0;if(f=e.name.split('.'),rtmedia_version_compare(rtm_wp_version,'3.9')?(i=uploaderObj.uploader.settings.filters.mime_types[0].extensions.split(',')):(i=uploaderObj.uploader.settings.filters[0].extensions.split(',')),f.length>1){if(h=f[f.length-1],h=h.toLowerCase(),jQuery.inArray(h,i)===-1)return!0}else return!0;rtmedia_version_compare(rtm_wp_version,'3.9')?uploaderObj.uploader.settings.filters.mime_types[0].title:uploaderObj.uploader.settings.filters[0].title,rtmedia_selected_file_list(plupload,e,'',''),a('#'+e.id+' .plupload_delete .remove-from-queue').click(function(c){return c.preventDefault(),uploaderObj.uploader.removeFile(b.getFile(e.id)),a('#'+e.id).remove(),rtMediaHook.call('rtmedia_js_file_remove',[b,e]),!1}),a('#label_'+e.id).click(function(b){b.preventDefault(),rtm_file_label=this,rtm_file_title_id='text_'+e.id,rtm_file_title_input='#'+rtm_file_title_id,rtm_file_title_wrapper_id='rtm_title_wp_'+e.id,rtm_file_title_wrapper='#'+rtm_file_title_wrapper_id,rtm_file_desc_id='rtm_desc_'+e.id,rtm_file_desc_input='#'+rtm_file_desc_id,rtm_file_desc_wrapper_id='rtm_desc_wp_'+e.id,rtm_file_desc_wrapper='#'+rtm_file_desc_wrapper_id,rtm_file_save_id='save_'+e.id,rtm_file_save_el='#'+rtm_file_save_id,jQuery(rtm_file_label).hide(),jQuery(rtm_file_label).siblings('.plupload_file_name_wrapper').hide(),jQuery(rtm_file_title_input).length===0?jQuery(rtm_file_label).parent('.plupload_file_name').prepend('<div id="'+rtm_file_title_wrapper_id+'" class="rtm-upload-edit-title-wrapper"><label>'+rtmedia_edit_media_info_upload.title+'</label><input type="text" class="rtm-upload-edit-title" id="'+rtm_file_title_id+'" value="'+e.title+'" style="width: 75%;" /></div><div id="'+rtm_file_desc_wrapper_id+'" class="rtm-upload-edit-desc-wrapper"><label>'+rtmedia_edit_media_info_upload.description+'</label><textarea class="rtm-upload-edit-desc" id="'+rtm_file_desc_id+'"></textarea></div><span id="'+rtm_file_save_id+'" title="Save Change" class="dashicons dashicons-yes"></span>'):(jQuery(rtm_file_title_wrapper).show(),jQuery(rtm_file_desc_wrapper).show(),jQuery(rtm_file_save_el).show()),jQuery(rtm_file_title_input).focus(),a('#save_'+e.id).click(function(f){var a,b,c,d;f.preventDefault(),rtm_file_label=this,rtm_file_title_id='text_'+e.id,rtm_file_title_input='#'+rtm_file_title_id,rtm_file_title_wrapper_id='rtm_title_wp_'+e.id,rtm_file_title_wrapper='#'+rtm_file_title_wrapper_id,rtm_file_desc_id='rtm_desc_'+e.id,rtm_file_desc_input='#'+rtm_file_desc_id,rtm_file_desc_wrapper_id='rtm_desc_wp_'+e.id,rtm_file_desc_wrapper='#'+rtm_file_desc_wrapper_id,rtm_file_save_id='save_'+e.id,rtm_file_save_el='#'+rtm_file_save_id,a=jQuery(rtm_file_title_input).val(),b=jQuery(rtm_file_desc_input).val(),c=jQuery(rtm_file_label).siblings('.plupload_file_name_wrapper'),''!==a.trim()&&(d=e.name.split('.')[1],c.text(a+'.'+d),e.title=a),b!=''&&(e.description=b),jQuery(rtm_file_title_wrapper).hide(),jQuery(rtm_file_desc_wrapper).hide(),c.show(),jQuery(rtm_file_label).siblings('#label_'+e.id).show(),jQuery(this).hide()})})}),a.each(d,function(c,a){b.getFile(a)&&b.removeFile(b.getFile(a))}),rtMediaHook.call('rtmedia_js_after_files_added',[b,e]),typeof rtmedia_direct_upload_enabled!='undefined'&&rtmedia_direct_upload_enabled=='1'){if(f=rtMediaHook.call('rtmedia_js_upload_file',{src:'uploader'}),f==!1)return!1;uploaderObj.uploadFiles()}c.focus()}),uploaderObj.uploader.bind('Error',function(c,a){var b,d;return a.code==-600?(d=tr='',b=a.file.name.split('.'),b.length>1&&(d=b[b.length-1],typeof c.settings.upload_size!='undefined'&&typeof c.settings.upload_size[d]!='undefined'&&typeof c.settings.upload_size[d].size||rtmedia_selected_file_list(plupload,a.file,c,a))):(a.code==-601&&(a.message=rtmedia_file_extension_error_msg),rtmedia_selected_file_list(plupload,a.file,'',a)),jQuery('.plupload_delete').on('click',function(a){a.preventDefault(),jQuery(this).parent().parent('li').remove()}),!1}),jQuery('.start-media-upload').on('click',function(c){var a,b;if(c.preventDefault(),a=jQuery('#media_search_input'),a.length>0&&a.val(''),jQuery('#rtmedia_uploader_filelist').children('li').length>0){if(b=rtMediaHook.call('rtmedia_js_upload_file',{src:'uploader'}),b==!1)return!1;uploaderObj.uploadFiles()}}),uploaderObj.uploader.bind('UploadProgress',function(d,b){var c=jQuery('<div/>',{class:'plupload_file_progress ui-widget-header'});c.css('width',b.percent+'%'),a('#'+b.id+' .plupload_file_status').html(c),rtMediaHook.call('rtm_custom_progress_bar_content',[b]),a('#'+b.id).addClass('upload-progress'),b.percent==100&&a('#'+b.id).toggleClass('upload-success'),window.onbeforeunload=function(b){var a=rtmedia_upload_progress_error_message;return a}}),uploaderObj.uploader.bind('BeforeUpload',function(b,c){var e,d;rtMediaHook.call('rtmedia_js_before_upload',{uploader:b,file:c,src:'uploader'}),b.settings.multipart_params.title=c.title.split('.')[0],typeof c.description!='undefined'?b.settings.multipart_params.description=c.description:b.settings.multipart_params.description='',e=a('#rtm-file_upload-ui select.privacy').val(),e!==void 0&&(b.settings.multipart_params.privacy=a('#rtm-file_upload-ui select.privacy').val()),d=a('#rt_upload_hf_redirect'),0<d.length&&(b.settings.multipart_params.redirect=b.files.length,b.settings.multipart_params.redirection=d.val()),jQuery('#rtmedia-uploader-form input[type=hidden]').each(function(){b.settings.multipart_params[a(this).attr('name')]=a(this).val()}),b.settings.multipart_params.activity_id=activity_id,a('#rtmedia-uploader-form .rtmedia-user-album-list').length>0?b.settings.multipart_params.album_id=a('#rtmedia-uploader-form .rtmedia-user-album-list').find(':selected').val():a('#rtmedia-uploader-form .rtmedia-current-album').length>0&&(b.settings.multipart_params.album_id=a('#rtmedia-uploader-form .rtmedia-current-album').val()),rtMediaHook.call('rtmedia_js_before_file_upload',[b,c])}),uploaderObj.uploader.bind('FileUploaded',function(e,c,d){if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var f=new Number(RegExp.$1);f<10&&typeof d.response!='undefined'&&(d.status=200)}try{b=JSON.parse(d.response),uploaderObj.uploader.settings.multipart_params.activity_id=b.activity_id,activity_id=b.activity_id,b.permalink!=''&&(a("#"+c.id+" .plupload_file_name").html("<a href='"+b.permalink+"' target='_blank' title='"+b.permalink+"'>"+c.title.substring(0,40).replace(/(<([^>]+)>)/ig,"")+"</a>"),a("#"+c.id+" .plupload_media_edit").html("<a href='"+b.permalink+"edit' target='_blank'><span title='"+rtmedia_edit_media+"'><i class='dashicons dashicons-edit'></i> "+rtmedia_edit+"</span></a>"),a("#"+c.id+" .plupload_delete").html("<span id='"+b.media_id+"' class='rtmedia-delete-uploaded-media dashicons dashicons-dismiss' title='"+rtmedia_delete+"'></span>"))}catch(a){}d.status==200||d.status==302?(uploaderObj.upload_count==void 0?uploaderObj.upload_count=1:uploaderObj.upload_count++,rtMediaHook.call('rtmedia_js_after_file_upload',[e,c,d.response])):a('#'+c.id+' .plupload_file_status').html(rtmedia_upload_failed_msg),files=e.files,lastfile=files[files.length-1]}),uploaderObj.uploader.refresh(),a('#rtMedia-start-upload').click(function(a){uploaderObj.uploadFiles(a)}),a('#rtMedia-start-upload').hide(),jQuery(document).on('click','#rtm_show_upload_ui',function(){jQuery('#rtm-media-gallery-uploader').slideToggle(),uploaderObj.uploader.refresh(),jQuery('#rtm_show_upload_ui').toggleClass('primary')})):jQuery(document).on('click','#rtm_show_upload_ui',function(){if('object'==typeof rtMedia_plupload_config){var a=rtMedia_plupload_config.filters[0].extensions.length;0===a&&rtmedia_gallery_action_alert_message(rtmedia_media_disabled_error_message,'warning')}jQuery('#rtm-media-gallery-uploader').slideToggle(),jQuery('#rtm_show_upload_ui').toggleClass('primary')}),jQuery(document).on('click','.plupload_delete .rtmedia-delete-uploaded-media',function(){var c=a(this),d,b,e;confirm(rtmedia_delete_uploaded_media)&&(d=a('#rtmedia-upload-container #rtmedia_media_delete_nonce').val(),b=a(this).attr('id'),e={action:'delete_uploaded_media',nonce:d,media_id:b},a.post(ajaxurl,e,function(d){d=='1'&&(c.closest('tr').remove(),a('#'+b).remove())}))})}),jQuery(document).ready(function(a){var k=function(b){if(b.keyCode===13){b.preventDefault(),a(this).trigger('click');var c=a('#whats-new');c.removeAttr('disabled'),setTimeout(function(){c.focus()},200)}},b,g,l,i,e,j,c,h,m,f;bp_template_pack&&'legacy'!==bp_template_pack&&(b=jQuery('#whats-new-form'),jQuery('#whats-new').on('focus',function(){var c=b.find('.rtmedia-uploader-div'),d=b.find('#rtmedia_uploader_filelist'),a=b.find('#whats-new-options');c.show(),0!==a.length&&(a.show(),a.css({opacity:'1'})),c.addClass('clearfix'),b.find('#rtmedia-action-update').removeClass('clearfix'),d.addClass('clear-both'),d.removeClass('clearfix')}),b.bind('reset',function(){b.find('.rtmedia-uploader-div').hide()}),b.bind('submit',function(){window.onbeforeunload=null,setTimeout(function(){b.find('.rtmedia-uploader-div').hide()},2e3)})),g=!1,l='#rtmedia-upload-container #rtMedia-upload-button',i='#rtmedia-upload-container input[type=file]:first',jQuery(document.body).on('click',i,function(){g=!0}),jQuery(document.body).on('click',l,function(){!1===g&&(jQuery(i).click(),g=!1)}),jQuery('#whats-new-post-in').on('change',function(a){jQuery(this).val()=='0'?jQuery('#whats-new-form #rtmedia-action-update .privacy').prop('disabled',!1).show():jQuery('#whats-new-form #rtmedia-action-update .privacy').prop('disabled',!0).hide()});let d=jQuery('#whats-new');if(d.on('keyup',function(a){if('&nbsp;'===d.val())d.css('color','transparent');else{let a=d.val().replace('&nbsp;','');d.val(a),d.css('color','inherit')}}),typeof rtMedia_update_plupload_config=='undefined')return!1;e=[],rtmedia_add_media_button_post_update||(rtmedia_add_media_button_post_update=a('#rtmedia-add-media-button-post-update')),rtmedia_add_media_button_post_update.length>0?(objUploadView=new UploadView(rtMedia_update_plupload_config),objUploadView.initUploader(),setTimeout(function(){rtmedia_add_media_button_post_update.length>0&&(a('#whats-new-options').prepend(a('#whats-new-form .rtmedia-plupload-container')),a('#whats-new-form #rtm-file_upload-ui .privacy').length>0&&a('#whats-new-form .rtmedia-plupload-container').append(a('#whats-new-form #rtm-file_upload-ui .privacy')),a('#whats-new-form #rtmedia-whts-new-upload-container > div').css('top','0'),a('#whats-new-form #rtmedia-whts-new-upload-container > div').css('left','0'))},100),bp_template_pack&&'legacy'!==bp_template_pack?(j=jQuery('#whats-new-form'),c=jQuery('.rtmedia-uploader-div'),0<jQuery('.activity-update-form').length&&0<j.length&&0<c.length&&(jQuery(j).append(c),c.hide())):(h=jQuery('#whats-new-options'),c=jQuery('#whats-new-form .rtmedia-uploader-div'),0<h.length&&0<c.length&&h.append(c)),rtmedia_add_media_button_post_update||(rtmedia_add_media_button_post_update=a('#rtmedia-add-media-button-post-update')),a('#whats-new-form').on('click',rtmedia_add_media_button_post_update,function(b){objUploadView.uploader.refresh(),a('#rtmedia-whts-new-upload-container > div').css('top','0'),a('#rtmedia-whts-new-upload-container > div').css('left','0'),/Edge/.test(navigator.userAgent)&&jQuery(this).closest('.rtm-upload-button-wrapper').find('input[type=file]').click(),a('#aw-whats-new-submit').prop('disabled',!1)}),objUploadView.upload_remove_array=[],objUploadView.uploader.bind('FilesAdded',function(b,c){if(jQuery('#whats-new-form').unbind('focusout'),a.each(c,function(h,c){var g,d,f,e;if(c.title=c.name.substring(0,c.name.lastIndexOf(".")),rtm_file_name_array=c.name.split('.'),g=rtMediaHook.call('rtmedia_js_file_added',[b,c,'#rtmedia_uploader_filelist']),g==!1)return c.status=-1,objUploadView.upload_remove_array.push(c.id),!0;if(objUploadView.uploader.settings.max_file_size<c.size)return!0;if(d=c.name.split('.'),rtmedia_version_compare(rtm_wp_version,'3.9')?(f=objUploadView.uploader.settings.filters.mime_types[0].extensions.split(',')):(f=objUploadView.uploader.settings.filters[0].extensions.split(',')),d.length>1){if(e=d[d.length-1],e=e.toLowerCase(),jQuery.inArray(e,f)===-1)return!0}else return!0;rtmedia_selected_file_list(plupload,c,'',''),jQuery('#whats-new-content').css('padding-bottom','0px'),a('#'+c.id+' .plupload_delete').click(function(d){return d.preventDefault(),objUploadView.uploader.removeFile(b.getFile(c.id)),a('#'+c.id).remove(),!1}),a('#label_'+c.id).click(function(a){a.preventDefault(),rtm_file_label=this,rtm_file_title_id='text_'+c.id,rtm_file_title_input='#'+rtm_file_title_id,rtm_file_title_wrapper_id='rtm_title_wp_'+c.id,rtm_file_title_wrapper='#'+rtm_file_title_wrapper_id,rtm_file_desc_id='rtm_desc_'+c.id,rtm_file_desc_input='#'+rtm_file_desc_id,rtm_file_desc_wrapper_id='rtm_desc_wp_'+c.id,rtm_file_desc_wrapper='#'+rtm_file_desc_wrapper_id,rtm_file_save_id='save_'+c.id,rtm_file_save_el='#'+rtm_file_save_id,jQuery(rtm_file_label).hide(),jQuery(rtm_file_label).siblings('.plupload_file_name_wrapper').hide(),jQuery(rtm_file_title_input).length===0?jQuery(rtm_file_label).parent('.plupload_file_name').prepend('<div id="'+rtm_file_title_wrapper_id+'" class="rtm-upload-edit-title-wrapper"><label>'+rtmedia_edit_media_info_upload.title+'</label><input type="text" class="rtm-upload-edit-title" id="'+rtm_file_title_id+'" value="'+c.title+'" style="width: 75%;" /></div><div id="'+rtm_file_desc_wrapper_id+'" class="rtm-upload-edit-desc-wrapper"><label>'+rtmedia_edit_media_info_upload.description+'</label><textarea class="rtm-upload-edit-desc" id="'+rtm_file_desc_id+'"></textarea></div><span id="'+rtm_file_save_id+'" title="Save Change" class="dashicons dashicons-yes"></span>'):(jQuery(rtm_file_title_wrapper).show(),jQuery(rtm_file_desc_wrapper).show(),jQuery(rtm_file_save_el).show()),jQuery(rtm_file_title_input).focus()}),rtm_file_save_id='save_'+c.id,rtm_file_save_el='#'+rtm_file_save_id,jQuery(document.body).on('click',rtm_file_save_el,function(f){var a,b,d,e;f.preventDefault(),rtm_file_title_id='text_'+c.id,rtm_file_title_input='#'+rtm_file_title_id,rtm_file_desc_id='rtm_desc_'+c.id,rtm_file_desc_input='#'+rtm_file_desc_id,rtm_file_title_wrapper_id='rtm_title_wp_'+c.id,rtm_file_title_wrapper='#'+rtm_file_title_wrapper_id,rtm_file_desc_wrapper_id='rtm_desc_wp_'+c.id,rtm_file_desc_wrapper='#'+rtm_file_desc_wrapper_id,a=jQuery(rtm_file_title_input).val(),b=jQuery(rtm_file_desc_input).val(),rtm_file_label='#label_'+c.id,d=jQuery(rtm_file_label).siblings('.plupload_file_name_wrapper'),''!==a.trim()&&(e=c.name.split('.')[1],d.text(a+'.'+e),c.title=a),b!=''&&(c.description=b),jQuery(rtm_file_title_wrapper).hide(),jQuery(rtm_file_desc_wrapper).hide(),d.show(),jQuery(rtm_file_label).siblings('.plupload_file_name_wrapper'),jQuery(rtm_file_label).show(),jQuery(this).hide()})}),a.each(objUploadView.upload_remove_array,function(c,a){b.getFile(a)&&b.removeFile(b.getFile(a))}),''===jQuery('#whats-new').val().trim())if(rtmedia_activity_text_with_attachment=='disable')a('#whats-new').css('color','transparent'),a('#whats-new').val('&nbsp;');else return jQuery('#whats-new-form').prepend('<div id="message" class="error bp-ajax-message" style="display: block;"><p> '+rtmedia_empty_activity_msg+' </p></div>'),jQuery('#whats-new').removeAttr('disabled'),!1;if(typeof rtmedia_direct_upload_enabled!='undefined'&&rtmedia_direct_upload_enabled=='1'){var d=rtMediaHook.call('rtmedia_js_upload_file',{src:'activity'});if(d==!1)return!1;objUploadView.uploadFiles()}a('#aw-whats-new-submit').focus(),a(document).off('keydown','#aw-whats-new-submit',k),a(document).on('keydown','#aw-whats-new-submit',k)}),objUploadView.uploader.bind('FileUploaded',function(f,g,b){var c,d;if(/MSIE (\d+\.\d+);/.test(navigator.userAgent))if(c=new Number(RegExp.$1),c<10)try{typeof JSON.parse(b.response)!='undefined'&&(b.status=200)}catch(a){}if(b.status==200){try{d=JSON.parse(b.response),a.each(d,function(c,b){e.push(b),a('#whats-new-form').find('#rtmedia_attached_id_'+b).length<1&&a('#whats-new-form').append("<input type='hidden' name='rtMedia_attached_files[]' data-mode='rtMedia-update' id='rtmedia_attached_id_"+b+"' value='"+b+"' />")})}catch(a){}rtMediaHook.call('rtmedia_js_after_file_upload',[f,g,b.response])}}),objUploadView.uploader.bind('Error',function(b,a){var c,d;return a.code==-600?(d=tr='',c=a.file.name.split('.'),c.length>1&&(d=c[c.length-1],typeof b.settings.upload_size!='undefined'&&typeof b.settings.upload_size[d]!='undefined'&&(b.settings.upload_size[d].size<1||b.settings.upload_size[d].size*1024*1024>=a.file.size)||rtmedia_selected_file_list(plupload,a.file,b,a))):(a.code==-601&&(a.message=rtmedia_file_extension_error_msg),rtmedia_selected_file_list(plupload,a.file,'',a)),jQuery('.plupload_delete').on('click',function(a){a.preventDefault(),jQuery(this).parent().parent('li').remove()}),!1}),objUploadView.uploader.bind('BeforeUpload',function(b,e){var d,c,f,g;rtMediaHook.call('rtmedia_js_before_upload',{uploader:b,file:e,src:'activity'}),a.each(objUploadView.upload_remove_array,function(c,a){b.getFile(a)&&b.removeFile(b.getFile(a))}),d='',c=0,'legacy'===bp_template_pack?(jQuery('#whats-new-post-in').length?c=jQuery('#whats-new-post-in').val():jQuery('.groups-header').length&&(c=jQuery('.groups-header').attr('data-bp-item-id')),c>0?d='group':d='profile'):(f=jQuery('#whats-new-post-in'),f.length?(d=f.val(),c=0):d='profile',g=jQuery('#whats-new-post-in-box-items li.bp-activity-object.selected input[type="hidden"]'),g.length&&(c=g.val())),b.settings.multipart_params.context=d,b.settings.multipart_params.context_id=c,b.settings.multipart_params.title=e.title,typeof e.description!='undefined'?b.settings.multipart_params.description=e.description:b.settings.multipart_params.description='',jQuery('#whats-new-form select.privacy').prop('disabled')===!1&&(b.settings.multipart_params.privacy=jQuery('#whats-new-form select.privacy').val())}),objUploadView.uploader.bind('UploadComplete',function(a,b){if(f=!0,bp_template_pack&&'legacy'!==bp_template_pack){if('disable'===rtmedia_activity_text_with_attachment&&''===jQuery.trim(jQuery('#whats-new').val())){let a=jQuery('#whats-new');a.css('color','transparent'),a.val(' ')}jQuery('#whats-new-form').submit()}else jQuery('#aw-whats-new-submit').click();jQuery('#whats-new-form #rtmedia_uploader_filelist li.plupload_queue_li').remove(),window.onbeforeunload=null}),objUploadView.uploader.bind('UploadProgress',function(d,b){var c=jQuery('<div/>',{class:'plupload_file_progress ui-widget-header'});c.css('width',b.percent+'%'),a('#'+b.id+' .plupload_file_status').html(c),rtMediaHook.call('rtm_custom_progress_bar_content',[b]),a('#'+b.id).addClass('upload-progress'),b.percent==100&&a('#'+b.id).toggleClass('upload-success'),window.onbeforeunload=function(b){var a=rtmedia_upload_progress_error_message;return a}}),a('#rtMedia-start-upload').hide(),m=!1,f=!1,a.ajaxPrefilter(function(c,b,k){var i,g,h,j,d;try{if(b.data==null||typeof b.data=='undefined'||typeof b.data.action=='undefined')return!0}catch(a){return!0}if(b.data.action=='post_update'||b.data.action=='activity_widget_filter'){for(i=e;e.length>0;)c.data+='&rtMedia_attached_files[]='+e.pop();g='',h=jQuery('#rtSelectPrivacy'),j=jQuery('#whats-new-form'),j.length>0&&h.length>0&&(g=h.val()),c.data+='&rtmedia-privacy='+g,e=i,d=b.success,c.beforeSend=function(){var d=rtMediaHook.call('rtmedia_js_before_activity_added',{src:'activity'}),e,c;if(!d)return a('#whats-new-form #rtmedia-whts-new-upload-container').find('input').removeAttr('disabled'),e=a('#whats-new'),e.removeAttr('disabled'),!1;if(b.data.action=='post_update')if(a.trim(a('#whats-new').val())==''&&objUploadView.uploader.files.length>0)if(rtmedia_activity_text_with_attachment=='disable')a("#whats-new").css('color','transparent'),a("#whats-new").val('&nbsp;');else return jQuery('#whats-new-form').prepend('<div id="message" class="error bp-ajax-message" style="display: block;"><p> '+rtmedia_empty_activity_msg+' </p></div>'),jQuery('#whats-new').removeAttr('disabled'),!1;return!f&&objUploadView.uploader.files.length>0?(a('#whats-new-post-in').attr('disabled','disabled'),rtmedia_add_media_button_post_update||(rtmedia_add_media_button_post_update=a('#rtmedia-add-media-button-post-update')),rtmedia_add_media_button_post_update.attr('disabled','disabled'),c=a('#rtmedia_upload_terms_conditions'),c.prop('checked')&&c.prop('disabled',!0),objUploadView.uploadFiles(),f=!0,!1):(f=!1,!0)},c.success=function(c){if(d&&'function'==typeof d&&d(c),c[0]+c[1]=='-1');else{for(b.data.action=='activity_widget_filter'&&(a('div.activity').bind('fadeIn',function(){apply_rtMagnificPopup(jQuery('.rtmedia-list-media, .rtmedia-activity-container ul.rtmedia-list, #bp-media-list,.widget-item-listing,.bp-media-sc-list, li.media.album_updated ul,ul.bp-media-list-media, li.activity-item div.activity-content div.activity-inner div.bp_media_content')),rtMediaHook.call('rtmedia_js_after_activity_added',[]),rtmedia_add_media_button_post_update||(rtmedia_add_media_button_post_update=jQuery('#rtmedia-add-media-button-post-update')),rtmedia_add_media_button_post_update.removeAttr('disabled')}),a('div.activity').fadeIn(100)),jQuery('input[data-mode=rtMedia-update]').remove();objUploadView.uploader.files.pop()!=void 0;);objUploadView.uploader.refresh(),a('#rtmedia-whts-new-upload-container > div').css({top:'0',left:'0'}),a('#whats-new-form #rtMedia-update-queue-list').html(''),apply_rtMagnificPopup(jQuery('.rtmedia-list-media, .rtmedia-activity-container ul.rtmedia-list, #bp-media-list,.widget-item-listing,.bp-media-sc-list, li.media.album_updated ul,ul.bp-media-list-media, li.activity-item div.activity-content div.activity-inner div.bp_media_content')),jQuery('ul.activity-list li.rtmedia_update:first-child .wp-audio-shortcode, ul.activity-list li.rtmedia_update:first-child .wp-video-shortcode').mediaelementplayer({classPrefix:'mejs-',defaultVideoWidth:480,defaultVideoHeight:270}),jQuery('.plupload_filelist_content.rtm-plupload-list').html(''),rtMediaHook.call('rtmedia_js_after_activity_added',[]),rtmedia_add_media_button_post_update||(rtmedia_add_media_button_post_update=jQuery('#rtmedia-add-media-button-post-update')),rtmedia_add_media_button_post_update.removeAttr('disabled')}rtmedia_on_activity_add(),a('#whats-new-post-in').removeAttr('disabled'),rtmedia_add_media_button_post_update||(rtmedia_add_media_button_post_update=a('#rtmedia-add-media-button-post-update')),rtmedia_add_media_button_post_update.removeAttr('disabled'),a('#whats-new').val(''),a('#whats-new').css('color','')}}})):a.ajaxPrefilter(function(d,b,f){var c,e;try{if(b.data==null||typeof b.data=='undefined'||typeof b.data.action=='undefined')return!0}catch(a){return!0}(b.data.action=='post_update'||b.data.action=='activity_widget_filter')&&(c='',jQuery('select.privacy').not('.rtm-activity-privacy-opt').length>0?c=jQuery('select.privacy').not('.rtm-activity-privacy-opt').val():jQuery('input[name="privacy"]').length>0&&(c=jQuery('input[name="privacy"]').val()),d.data+='&rtmedia-privacy='+c,e=b.done,d.done=function(c){e(c),c[0]+c[1]=='-1'||b.data.action=='activity_widget_filter'&&a('div.activity').fadeIn(100),a('#whats-new-post-in').removeAttr('disabled'),a('#whats-new').css('color','')})})}),jQuery(document).ready(function(a){jQuery(document).on('click','#rt_media_comment_form #rt_media_comment_submit',function(h){var g=this,b=jQuery(this).attr('widget_id'),c=jQuery(this).closest('form'),d=c.find('#comment_content'),e=!1,f=jQuery.trim(d.val());return comment_attached_id=c.find('input[name="rtMedia_attached_files[]"]').val(),typeof comment_attached_id=='undefined'&&f==''?e=1:comment_attached_id==''&&f==''&&(e=2),e?(rtmedia_single_media_alert_message(rtmedia_empty_comment_msg,'warning',!0),b?rtmedia_comment_media_input_button(b,!1):rtmedia_comment_submit_button_disable(!1),!1):(a(this).attr('disabled','disabled'),''===d.val().replace(/\&nbsp;/g,'')&&d.val(''),a.ajax({url:c.attr('action'),type:'post',data:c.serialize()+'&rtajax=true',success:function(c){a('#rtmedia-no-comments').remove(),a('#rtmedia_comment_ul').append(c),d.val(''),b?(rtmedia_comment_media_remove_hidden_media_id(b),rtmedia_comment_media_textbox_val(b,!1),rtmedia_comment_media_input_button(b,!1)):rtmedia_comment_submit_button_disable(!1),rtmedia_apply_popup_to_media(),rtmedia_reset_video_and_audio_for_popup(),rtMediaHook.call('rtmedia_js_after_comment_added',[]),rtMediaScrollComments(),!1==a('body').hasClass('activity')&&!1==a('body').hasClass('groups')&&galleryObj.reloadView()},error:function(a){b?(rtmedia_comment_media_input_button(b,!1),rtmedia_comment_media_remove_hidden_media_id(b)):rtmedia_comment_submit_button_disable(!1)}}),!1)}),jQuery(document).on('click','.rtmedia-delete-comment',function(f){var b,a,d,c,e;if(f.preventDefault(),b=!0,b=rtMediaHook.call('rtmedia_js_delete_comment_confirmation',[b]),b&&!confirm(rtmedia_media_comment_delete_confirmation))return!1;if(a=jQuery(this),d=a.parent(),c=a.data('id'),d.css('opacity','0.4'),c==''||isNaN(c))return!1;e=a.closest('ul').data('action'),jQuery.ajax({url:e,type:'post',data:{comment_id:c},success:function(b){b!='undefined'&&b==1?a.closest('li').hide(1e3,function(){a.closest('li').remove()}):d.css('opacity','1'),rtMediaHook.call('rtmedia_js_after_comment_deleted',[])}})}),a(document).on('click','.rtmedia-like',function(e){var b,c,d;e.preventDefault(),b=this,c=a('#rtm_media_like_nonce').val(),a(this).attr('disabled','disabled'),d=a(this).parent().attr('action'),a(b).prepend("<img class='rtm-like-loading' src='"+rMedia_loading_file+"' style='width:10px' />"),a.ajax({url:d,type:'post',data:{json:!0,like_nonce:c},success:function(c){try{c=JSON.parse(c)}catch(a){}a('.rtmedia-like span').html(c.next),a('.rtmedia-like').attr('title',c.next),a('.rtmedia-like-counter-wrap').html(c.person_text),a('.rtm-like-loading').remove(),a(b).removeAttr('disabled');var d=a('.rtmedia-comments-container').length;c.count>0?a('.rtmedia-like-info, .rtm-like-comments-info').removeClass('hide'):(a('.rtmedia-like-info').addClass('hide'),0===d&&a('.rtm-like-comments-info').addClass('hide'))}})}),a(document).on('click','.rtmedia-featured, .rtmedia-group-featured',function(e){var b,c,d;e.preventDefault(),b=this,a(this).attr('disabled','disabled'),c=a(this).siblings('#rtm_media_featured_nonce').val(),d=a(this).parent().attr('action'),a(b).prepend("<img class='rtm-featured-loading' src='"+rMedia_loading_file+"' />"),a.ajax({url:d,type:'post',data:{json:!0,featured_nonce:c},success:function(c){try{c=JSON.parse(c)}catch(a){}c.nonce?rtmedia_single_media_alert_message(rtmedia_something_wrong_msg,'warning'):c.action?rtmedia_single_media_alert_message(rtmedia_set_featured_image_msg,'success'):rtmedia_single_media_alert_message(rtmedia_unset_featured_image_msg,'success'),a(b).find('span').html(c.next),a('.rtm-featured-loading').remove(),a(b).removeAttr('disabled')}})}),jQuery('#div-attache-rtmedia').find('input[type=file]').each(function(){});var b=a.fn.fadeIn;jQuery.fn.fadeIn=function(){return b.apply(this,arguments).trigger('fadeIn')}});function rtmedia_selected_file_list(p,b,m,f,c){var g='',h='',k='',d='',j,n,a,o,l,e,i;bp_template_pack&&'legacy'!==bp_template_pack&&(j=jQuery('#aw-whats-new-submit'),0<j.length&&(n=jQuery('<input>',{type:'button',class:'button',name:'aw-whats-new-submit',id:'aw-whats-new-submit',value:j.val()}),j.replaceWith(n),n.on('click',function(a){rtmedia_add_media_button_post_update||(rtmedia_add_media_button_post_update=jQuery('#rtmedia-add-media-button-post-update')),rtmedia_add_media_button_post_update.prop('disabled',!0),rtMediaHook.call('rtmedia_js_before_activity_added',{src:'activity'})&&objUploadView.uploadFiles(a)}))),rtmedia_uploader_filelist=typeof c=="undefined"?"#rtmedia_uploader_filelist":"#rtmedia_uploader_filelist-"+c,plupload_delete=typeof c=="undefined"?"plupload_delete":"plupload_delete-"+c,f==''?(k='<div class="plupload_file_progress ui-widget-header" style="width: 0%;">',k+='</div>',g='<span id="label_'+b.id+'" class="dashicons dashicons-edit" title="'+rtmedia_backbone_strings.rtm_edit_file_name+'"></span>'):f.code==-600?(alert(rtmedia_max_file_msg+m.settings.max_file_size),h=m!=''?rtmedia_max_file_msg+m.settings.max_file_size:window.file_size_info,d="title='"+h+"'",g='<i class="dashicons dashicons-info" '+d+'></i>'):f.code==-601&&(h=f.message+'. '+window.file_extn_info,d="title='"+h+"'",g='<i class="dashicons dashicons-info" '+d+'></i>'),a='<li class="plupload_file ui-state-default plupload_queue_li" id="'+b.id+'" '+d+'>',a+='<div id="file_thumb_'+b.id+'" class="plupload_file_thumb">',a+='</div>',a+='<div class="plupload_file_status">',a+=k,a+='</div>',a+='<div class="plupload_file_name" title="'+(b.name?b.name:'')+'">',a+='<span class="plupload_file_name_wrapper">',a+=b.name?b.name:'',a+='</span>',a+=g,a+='</div>',a+='<div class="plupload_file_action">',a+='<div class="plupload_action_icon ui-icon '+plupload_delete+'">',a+='<span class="remove-from-queue dashicons dashicons-dismiss"></span>',a+='</div>',a+='</div>',a+='<div class="plupload_file_size">',a+=p.formatSize(b.size).toUpperCase(),a+='</div>',a+='<div class="plupload_file_fields">',a+='</div>',a+='</li>',jQuery(a).appendTo(rtmedia_uploader_filelist),c?jQuery('#rtmedia-comment-media-upload-'+c).focus():jQuery('#whats-new').focus(),o=b.type,l=b.name,e=l.substring(l.lastIndexOf('.')+1,l.length),/image/i.test(o)?e==='gif'?jQuery('<img src="'+rtmedia_media_thumbs.photo+'" />').appendTo('#file_thumb_'+b.id):(i=new mOxie.Image,i.onload=function(){this.embed(jQuery('#file_thumb_'+b.id).get(0),{width:100,height:60,crop:!0})},i.onembedded=function(){this.destroy()},i.onerror=function(){this.destroy()},i.load(b.getSource())):jQuery.each(rtmedia_exteansions,function(c,d){if(d.indexOf(e)>=0){var a='';return rtmedia_media_thumbs[e]?a=rtmedia_media_thumbs[e]:a=rtmedia_media_thumbs[c],jQuery('<img />',{src:a}).appendTo('#file_thumb_'+b.id),!1}})}function change_rtBrowserAddressUrl(b,c){if(typeof history.pushState!='undefined'){var a={Page:c,Url:b};history.pushState(a,a.Page,a.Url)}}function getQueryStringValue(a){return decodeURIComponent(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+encodeURIComponent(a).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))}function check_condition(a){return window.location.href.indexOf(a)>0}function check_url(a){var c,d,b;return!!(a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),c="[\\?&]"+a+"=([^&#]*)",d=new RegExp(c),b=d.exec(window.location.href),null!==b)&&b[1]}commentObj={},plupload_comment_main={},comment_media_wrapper='comment-media-wrapper-',rtmedia_comment_media_submit='rtmedia-comment-media-submit-',comment_media_add_button='rtmedia-comment-media-upload-',comment_media_uplaod_media='rtMedia-start-upload-',jQuery(document).ready(function(a){rtMediaHook.register('rtmedia_js_popup_after_content_added',function(){var a=jQuery('.rtmedia-single-container .rtmedia-single-meta .rtm-media-single-comments form');return rtmedia_comment_media_upload(a),rtmedia_apply_popup_to_media(),!0}),rtmedia_apply_popup_to_media(),rtmedia_comment_media_single_page(),rtmedia_activity_comment_js_add_media_id(),rtmedia_activity_stream_comment_media(),rtmedia_buddypress_load_newest_button_click()});function rtmedia_reset_video_and_audio(){jQuery('ul.activity-list li.activity-item div.rtmedia-item-thumbnail > audio.wp-audio-shortcode, ul.activity-list li.activity-item div.rtmedia-item-thumbnail > video.wp-video-shortcode').mediaelementplayer({classPrefix:'mejs-',defaultVideoWidth:480,defaultVideoHeight:270})}function rtmedia_on_activity_add(){setTimeout(function(){rtmedia_activity_stream_comment_media(),rtmedia_reset_video_and_audio(),rtmedia_apply_popup_to_media()},1500)}function rtmedia_single_page_popup_close(){typeof rtmedia_media_size_config!='undefined'&&typeof rtmedia_media_size_config.video.activity_media!='undefined'&&jQuery('.rtmedia-single-container .rtmedia-comment-media-container .mejs-container.mejs-video').css({height:rtmedia_media_size_config.video.activity_media.height,width:rtmedia_media_size_config.video.activity_media.width})}function rtmedia_reset_video_and_audio_for_popup(){jQuery('.rtm-lightbox-container .rtmedia-comments-container ul.rtm-comment-list li.rtmedia-comment div.rtmedia-item-thumbnail > audio.wp-audio-shortcode, .rtm-lightbox-container .rtmedia-comments-container ul.rtm-comment-list li.rtmedia-comment div.rtmedia-item-thumbnail > video.wp-video-shortcode').mediaelementplayer({classPrefix:'mejs-',defaultVideoWidth:200,defaultVideoHeight:200})}function rtmedia_comment_media_uplaod_button_disble(b,a){typeof a!='undefined'&&jQuery('#'+comment_media_add_button+b).prop('disabled',a)}function rtmedia_apply_popup_to_media(){typeof rtmedia_lightbox_enabled!='undefined'&&rtmedia_lightbox_enabled=='1'&&apply_rtMagnificPopup('.rtmedia-comment-media-container ul.rtmedia-comment-media-list, .rtmedia-list-media.rtm-gallery-list, .rtmedia-activity-container ul.rtmedia-list, #bp-media-list,.bp-media-sc-list, li.media.album_updated ul,ul.bp-media-list-media, li.activity-item div.activity-content div.activity-inner div.bp_media_content, .rtm-bbp-container, ul.rtm-comment-container')}function rtmedia_comment_media_enable_diable_media_comment(b){var a=jQuery(b).attr('widget_id');typeof a!='undefined'?rtmedia_comment_media_uplaod_button_disble(a,!1):jQuery('.rt_media_comment_form_with_media .rtmedia-comment-media-upload').prop('disabled',!1)}function rtmedia_add_comment_media_button_click(a){jQuery('.'+rtmedia_comment_media_submit+a).on('click',function(c){c.preventDefault();var b=jQuery(this).attr('media');if(typeof b!='undefined'&&b==1)return rtmedia_comment_media_input_button(a,!0),rtmedia_comment_media_textbox_val(a,!0),jQuery(this).attr('media',0),commentObj[a].uploadFiles(),!1})}function rtmedia_comment_submit_button_disable(a){'boolean'==typeof a&&jQuery('#rt_media_comment_form #rt_media_comment_submit').prop('disabled',a)}function rtmedia_comment_media_input_button(a,b){rtmedia_comment_media_upload_button_post_disable(a,b),rtmedia_comment_media_uplaod_button_disble(a,b),rtmedia_uploaded_media_edit_disable(a,b)}function rtmedia_uploaded_media_edit_disable(a,b){b?(jQuery('.'+comment_media_wrapper+a).find('.plupload_filelist_content .dashicons').hide(),jQuery('.'+comment_media_wrapper+a).find('.plupload_file_action').hide()):(jQuery('.'+comment_media_wrapper+a).find('.plupload_file_action').show(),jQuery('.'+comment_media_wrapper+a).find('.plupload_filelist_content .dashicons').show())}function rtmedia_disable_comment_textbox(b,c){var a='.'+comment_media_wrapper+b;jQuery(a).length>0&&(comment_string=jQuery(a).find('textarea').val(),comment_string.includes('&nbsp;')&&jQuery(a).find('textarea.ac-input').val(''),jQuery(a).find('textarea').prop('disabled',c),jQuery(a).find('textarea').css('color',''))}function rtmedia_comment_media_textbox_val(b,c){var a='.'+comment_media_wrapper+b,d;jQuery(a).length>0&&jQuery(a).find('textarea.ac-input').length>0&&(c==!0?(d=jQuery(a).find('textarea.ac-input').val(),d==""&&(jQuery(a).find('textarea.ac-input').val('&nbsp;'),jQuery(a).find('textarea').css('color','transparent'))):(jQuery(a).find('textarea.ac-input').val(''),jQuery(a).find('textarea').css('color','')))}function rtmedia_comment_media_upload_button_post_disable(a,b){typeof b!='undefined'&&(jQuery('.'+rtmedia_comment_media_submit+a).prop('disabled',b),b==!0?jQuery('.'+rtmedia_comment_media_submit+a).closest('div.ac-reply-content').find('a.ac-reply-cancel').attr("disabled","disabled"):jQuery('.'+rtmedia_comment_media_submit+a).closest('div.ac-reply-content').find('a.ac-reply-cancel').removeAttr("disabled"))}function rtmedia_comment_media_remove_hidden_media_id(a){jQuery('.'+comment_media_wrapper+a).find('input[name="rtMedia_attached_files[]"]').remove()}function rtmedia_activity_comment_js_add_media_id(){jQuery.ajaxPrefilter(function(c,a,f){var d,b,e;try{if(a.data==null||typeof a.data=='undefined'||typeof a.data.action=='undefined')return!0}catch(a){return!0}a.data.action=='new_activity_comment'&&(widget_id='activity-'+a.data.form_id,d=1,typeof rtmedia_disable_media_in_commented_media!='undefined'&&(d=rtmedia_disable_media_in_commented_media),b=jQuery('.'+comment_media_wrapper+widget_id).find('input[name="rtMedia_attached_files[]"]').val(),typeof b=='undefined'&&(b=0),typeof b==''&&(b=0),c.data+='&rtMedia_attached_files[]='+b,c.data+='&rtmedia_disable_media_in_commented_media='+d,activity_attachemnt_ids=b,e=a.success,c.beforeSend=function(){if(a.data.action=='new_activity_comment')if(d==1)if(a.data.form_id!=a.data.comment_id&&b>0)return jQuery('.'+comment_media_wrapper+widget_id).append('<div id="message" class="error bp-ajax-message" style="display: block;"><p> '+rtmedia_disable_media_in_commented_media_text+' </p></div>'),jQuery('.'+comment_media_wrapper+widget_id).removeAttr('disabled'),rtmedia_comment_media_input_button(widget_id,!1),rtmedia_disable_comment_textbox(widget_id,!1),!1},c.success=function(b){e&&'function'==typeof e&&e(b),b[0]+b[1]=='-1'||a.data.action=='new_activity_comment'&&(rtmedia_comment_media_remove_hidden_media_id(widget_id),rtmedia_comment_media_textbox_val(widget_id,!1),rtmedia_comment_media_input_button(widget_id,!1),setTimeout(function(){rtmedia_apply_popup_to_media(),rtmedia_reset_video_and_audio()},500),rtMediaHook.call('rtmedia_js_after_comment_added',[]))},c.error=function(){a.data.action=='new_activity_comment'&&(rtmedia_comment_media_remove_hidden_media_id(widget_id),rtmedia_comment_media_textbox_val(widget_id,!1),rtmedia_comment_media_input_button(widget_id,!1))})})}function rtmedia_buddypress_load_newest_button_click(){jQuery('body #buddypress').on('click','ul.activity-list li.load-newest a',function(a){a.preventDefault(),rtmedia_apply_popup_to_media(),rtmedia_activity_stream_comment_media()})}function rtmedia_comment_media_upload_button_class(a){jQuery('form.'+comment_media_wrapper+a).find('input[type="submit"].rt_media_comment_submit').addClass(rtmedia_comment_media_submit+a),jQuery('form.'+comment_media_wrapper+a).find('input[name="ac_form_submit"]').addClass(rtmedia_comment_media_submit+a),rtmedia_add_widget_id_in_submit_button(a)}function rtmedia_add_widget_id_in_submit_button(a){jQuery('.'+rtmedia_comment_media_submit+a).attr('widget_id',a)}function rtmedia_comment_media_upload_button_has_media(b,a){typeof a!='undefined'&&jQuery('.'+rtmedia_comment_media_submit+b).attr('media',a)}function rtmedia_comment_media_media_id(a,b){jQuery('.'+comment_media_wrapper+a).find('#rtmedia_attached_id_'+b).length<1&&(rtmedia_comment_media_remove_hidden_media_id(a),jQuery('.'+comment_media_wrapper+a).append("<input type='hidden' name='rtMedia_attached_files[]' data-mode='rtmedia-update' id='rtmedia_attached_id_"+b+"' value='"+b+"' />"))}function rtmedia_add_comment_media_button_trigger(a){jQuery('.'+rtmedia_comment_media_submit+a).length>0&&jQuery('.'+rtmedia_comment_media_submit+a).trigger('click')}function renderUploadercomment_media(a,f){var b=comment_media_add_button+a,d,e,g,c;if(jQuery('#'+b).length>0&&jQuery("#"+b).closest('form').find('input[type="file"]').length==0){if(jQuery('#'+b).closest('form').addClass(comment_media_wrapper+a),rtmedia_comment_media_upload_button_class(a),typeof rtMedia_update_plupload_comment=='undefined')return!1;d=rtMedia_update_plupload_comment,d.browse_button=b,d.container='rtmedia-comment-media-upload-container-'+a,plupload_comment_main[a]=d,commentObj[a]=new UploadView(eval(plupload_comment_main[a])),commentObj[a].initUploader(!1),e=!1,g='#'+d.container+' input[type=file]:first',jQuery(document.body).on('click',g,function(){e=!0}),jQuery(document.body).on('click','#'+b,function(){!1===e&&(jQuery(g).click(),e=!1),jQuery(this).blur()}),c=jQuery("."+comment_media_wrapper+a),jQuery(c).find('div.rtmedia-plupload-container').length&&(f=="activity"&&c.find('.ac-reply-content .ac-textarea').after(c.find('div.rtmedia-plupload-container .rtmedia-comment-media-upload')),f=="rtmedia"&&c.find('textarea').after(c.find('div.rtmedia-plupload-container .rtmedia-comment-media-upload'))),jQuery("#"+comment_media_uplaod_media+a).hide(),jQuery("#"+comment_media_uplaod_media+a).click(function(b){rtmedia_comment_media_upload_button_post_disable(a,!0),commentObj[a].uploadFiles(b),commentObj[a].uploader.refresh()}),rtmedia_add_comment_media_button_click(a),commentObj[a].uploader.bind('FilesAdded',function(b,c){while(b.files.length>1)b.removeFile(b.files[0]);commentObj[a].upload_remove_array=[],jQuery('#rtmedia_uploader_filelist-'+a+' li.plupload_queue_li').remove(),rtmedia_comment_media_upload_button_has_media(a,1),jQuery.each(c,function(h,c){var g,d,f,e;if(rtm_file_name_array=c.name.split('.'),c.title=rtm_file_name_array[0],g=rtMediaHook.call('rtmedia_js_file_added',[b,c,'#rtmedia_uploader_filelist-'+a]),g==!1)return c.status=-1,commentObj[a].upload_remove_array.push(c.id),!0;if(commentObj[a].uploader.settings.max_file_size<c.size)return!0;if(d=c.name.split('.'),rtmedia_version_compare(rtm_wp_version,'3.9')?(f=commentObj[a].uploader.settings.filters.mime_types[0].extensions.split(',')):(f=commentObj[a].uploader.settings.filters[0].extensions.split(',')),d.length>1){if(e=d[d.length-1],e=e.toLowerCase(),jQuery.inArray(e,f)===-1)return!0}else return!0;rtmedia_selected_file_list(plupload,c,'','',a),jQuery("#"+c.id+" .plupload_delete-"+a+" .remove-from-queue").click(function(d){return d.preventDefault(),jQuery("."+rtmedia_comment_media_submit+a).attr('media','0'),commentObj[a].uploader.removeFile(b.getFile(c.id)),jQuery("#"+c.id).remove(),!1}),jQuery('#label_'+c.id).click(function(a){a.preventDefault(),rtm_file_label=this,rtm_file_title_id='text_'+c.id,rtm_file_title_input='#'+rtm_file_title_id,rtm_file_title_wrapper_id='rtm_title_wp_'+c.id,rtm_file_title_wrapper='#'+rtm_file_title_wrapper_id,rtm_file_desc_id='rtm_desc_'+c.id,rtm_file_desc_input='#'+rtm_file_desc_id,rtm_file_desc_wrapper_id='rtm_desc_wp_'+c.id,rtm_file_desc_wrapper='#'+rtm_file_desc_wrapper_id,rtm_file_save_id='save_'+c.id,rtm_file_save_el='#'+rtm_file_save_id,jQuery(rtm_file_label).hide(),jQuery(rtm_file_label).siblings('.plupload_file_name_wrapper').hide(),jQuery(rtm_file_title_input).length===0?jQuery(rtm_file_label).parent('.plupload_file_name').prepend('<div id="'+rtm_file_title_wrapper_id+'" class="rtm-upload-edit-title-wrapper"><label>'+rtmedia_edit_media_info_upload.title+'</label><input type="text" class="rtm-upload-edit-title" id="'+rtm_file_title_id+'" value="'+c.title+'" style="width: 75%;" /></div><div id="'+rtm_file_desc_wrapper_id+'" class="rtm-upload-edit-desc-wrapper"><label>'+rtmedia_edit_media_info_upload.description+'</label><textarea class="rtm-upload-edit-desc" id="'+rtm_file_desc_id+'"></textarea></div><span id="'+rtm_file_save_id+'" title="Save Change" class="dashicons dashicons-yes"></span>'):(jQuery(rtm_file_title_wrapper).show(),jQuery(rtm_file_desc_wrapper).show(),jQuery(rtm_file_save_el).show()),jQuery(rtm_file_title_input).focus()}),rtm_file_save_id='save_'+c.id,rtm_file_save_el='#'+rtm_file_save_id,jQuery(document.body).on('click',rtm_file_save_el,function(f){var a,b,d,e;f.preventDefault(),rtm_file_title_id='text_'+c.id,rtm_file_title_input='#'+rtm_file_title_id,rtm_file_desc_id='rtm_desc_'+c.id,rtm_file_desc_input='#'+rtm_file_desc_id,rtm_file_title_wrapper_id='rtm_title_wp_'+c.id,rtm_file_title_wrapper='#'+rtm_file_title_wrapper_id,rtm_file_desc_wrapper_id='rtm_desc_wp_'+c.id,rtm_file_desc_wrapper='#'+rtm_file_desc_wrapper_id,a=jQuery(rtm_file_title_input).val(),b=jQuery(rtm_file_desc_input).val(),rtm_file_label='#label_'+c.id,d=jQuery(rtm_file_label).siblings('.plupload_file_name_wrapper'),''!==a.trim()&&(e=c.name.split('.')[1],d.text(a+'.'+e),c.title=a),b!=''&&(c.description=b),jQuery(rtm_file_title_wrapper).hide(),jQuery(rtm_file_desc_wrapper).hide(),d.show(),jQuery(rtm_file_label).siblings('.plupload_file_name_wrapper'),jQuery(rtm_file_label).show(),jQuery(this).hide()})}),jQuery.each(commentObj[a].upload_remove_array,function(c,a){b.getFile(a)&&b.removeFile(b.getFile(a))}),rtMediaHook.call('rtmedia_js_after_files_added',[b,c]),'undefined'!=typeof rtmedia_direct_upload_enabled&&'1'==rtmedia_direct_upload_enabled&&(jQuery('.rtmedia-comment-media-submit-'+a).focus(),jQuery('.'+rtmedia_comment_media_submit+a).trigger('click')),jQuery('.rtmedia-comment-media-submit-'+a).focus()}),commentObj[a].uploader.bind('FileUploaded',function(e,f,b){var c,d;if(/MSIE (\d+\.\d+);/.test(navigator.userAgent))if(c=new Number(RegExp.jQuery1),c<10)try{typeof JSON.parse(b.response)!='undefined'&&(b.status=200)}catch(a){}if(b.status==200){try{d=JSON.parse(b.response),jQuery.each(d,function(c,b){rtmedia_comment_media_upload_button_post_disable(a,!1),rtmedia_comment_media_media_id(a,b),rtmedia_add_comment_media_button_trigger(a)})}catch(a){}rtMediaHook.call('rtmedia_js_after_file_upload',[e,f,b.response])}}),commentObj[a].uploader.bind('Error',function(c,b){var d,e;return rtmedia_comment_media_upload_button_post_disable(a,!1),b.code==-600?(e=tr='',d=b.file.name.split('.'),d.length>1&&(e=d[d.length-1],typeof c.settings.upload_size!='undefined'&&typeof c.settings.upload_size[e]!='undefined'&&(c.settings.upload_size[e].size<1||c.settings.upload_size[e].size*1024*1024>=b.file.size)||rtmedia_selected_file_list(plupload,b.file,c,b,a))):(b.code==-601&&(b.message=rtmedia_file_extension_error_msg),rtmedia_selected_file_list(plupload,b.file,'',b,a)),jQuery('.plupload_delete-'+a).on('click',function(b){b.preventDefault(),jQuery("."+rtmedia_comment_media_submit+a).attr('media','0'),jQuery(this).parent().parent('li').remove()}),!1}),commentObj[a].uploader.bind('BeforeUpload',function(b,c){jQuery.each(commentObj[a].upload_remove_array,function(c,a){b.getFile(a)&&b.removeFile(b.getFile(a))}),item_id=0,object='profile',b.settings.multipart_params.context=object,b.settings.multipart_params.comment_media_activity_id=a,b.settings.multipart_params.context_id=item_id,b.settings.multipart_params.rtmedia_update=!0,b.settings.multipart_params.activity_id='null',b.settings.multipart_params.title=c.title.split('.')[0],typeof c.description!='undefined'?b.settings.multipart_params.description=c.description:b.settings.multipart_params.description=''}),commentObj[a].uploader.bind('UploadComplete',function(b,c){jQuery('#rtmedia_uploader_filelist-'+a+' li').remove(),window.onbeforeunload=null}),commentObj[a].uploader.bind('UploadProgress',function(c,a){var b=jQuery('<div/>',{class:'plupload_file_progress ui-widget-header'});b.css('width',a.percent+'%'),jQuery('#'+a.id+' .plupload_file_status').html(b),rtMediaHook.call('rtm_custom_progress_bar_content',[a]),jQuery('#'+a.id).addClass('upload-progress'),a.percent==100&&jQuery('#'+a.id).toggleClass('upload-success'),window.onbeforeunload=function(b){var a=rtmedia_upload_progress_error_message;return a}}),commentObj[a].uploader.refresh()}}function rtmedia_comment_media_upload(a){var c,b,d;typeof a!='undefined'&&jQuery(a).find('.rt_upload_hf_upload_parent_id').length>0&&(c=jQuery(a).find('.rt_upload_hf_upload_parent_id').val(),b=jQuery(a).find('.rt_upload_hf_upload_parent_id_type').val(),typeof c!='undefined'&&typeof b!='undefined'&&(d=b+'-'+c,renderUploadercomment_media(d,b)))}function rtmedia_activity_stream_comment_media(){bp_template_pack&&'legacy'!==bp_template_pack?jQuery('#buddypress div#activity-stream ul.activity-list li.activity-item, #buddypress ul#activity-stream ul.activity-list li.activity-item').each(function(){if(jQuery(this).find('.rt_upload_hf_upload_parent_id').length&&jQuery(this).find('.rt_upload_hf_upload_parent_id_type').length)if(jQuery(this).find("input[type=file]").length==0){var a=jQuery(this).find('.rtmedia-uploader-div');jQuery(this).find('.ac-form').append(a.html()),a.remove(),rtmedia_comment_media_upload(this)}}):jQuery('#buddypress ul#activity-stream li.activity-item').each(function(){jQuery(this).find('.rt_upload_hf_upload_parent_id').length&&jQuery(this).find('.rt_upload_hf_upload_parent_id_type').length&&rtmedia_comment_media_upload(this)})}function rtmedia_comment_media_single_page(){var a=jQuery('.rtmedia-single-container .rtmedia-single-meta .rtmedia-item-comments form');rtmedia_comment_media_upload(a)}function rtmedia_disable_popup_navigation_comment_media_focus(){rtmedia_disable_popup_navigation('.plupload_filelist_content li input.rtm-upload-edit-title'),rtmedia_disable_popup_navigation('.plupload_filelist_content li textarea.rtm-upload-edit-desc')}function rtmedia_disable_popup_navigation(a){jQuery(document).on('focusin',a,function(){jQuery(document).unbind('keydown')}),jQuery(document).on('focusout',a,function(){var a=jQuery.magnificPopup.instance;jQuery(document).on('keydown',function(b){b.keyCode===37?a.prev():b.keyCode===39&&a.next()})})}const rtMediaScrollComments=()=>{const a=document.getElementById('rtmedia_comment_ul');if(a!==null){const b=a.offsetHeight*1e3;a.scrollTo({top:b,behavior:'smooth'})}}