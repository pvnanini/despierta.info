var em_ajaxify,em_maps_loaded,maps,maps_markers,infoWindow;jQuery(document).ready(function(a){var b=!1,e,c,k,l,h,f,g;a('#start-time').each(function(c,b){a(b).addClass('em-time-input em-time-start').next('#end-time').addClass('em-time-input em-time-end').parent().addClass('em-time-range')}),a(".em-time-input").length>0&&em_setup_timepicker('body'),a('.em-calendar-wrapper a').off("click"),a('.em-calendar-wrapper').on('click','a.em-calnav, a.em-calnav',function(b){b.preventDefault(),a(this).closest('.em-calendar-wrapper').prepend('<div class="loading" id="em-loading"></div>');var c=em_ajaxify(a(this).attr('href'));a(this).closest('.em-calendar-wrapper').load(c,function(){a(this).trigger('em_calendar_load')})}),a(document).on('click change','.em-toggle',function(d){var b,c;d.preventDefault(),b=a(this),c=b.attr('rel').split(':'),b.hasClass('show-search')?(c.length>1?b.closest(c[1]).find(c[0]).slideUp():a(c[0]).slideUp(),b.find('.show, .show-advanced').show(),b.find('.hide, .hide-advanced').hide(),b.removeClass('show-search')):(c.length>1?b.closest(c[1]).find(c[0]).slideDown():a(c[0]).slideDown(),b.find('.show, .show-advanced').hide(),b.find('.hide, .hide-advanced').show(),b.addClass('show-search'))}),EM.search_term_placeholder&&('placeholder'in document.createElement('input')?a('input.em-events-search-text, input.em-search-text').attr('placeholder',EM.search_term_placeholder):a('input.em-events-search-text, input.em-search-text').on('blur',function(){this.value==''&&(this.value=EM.search_term_placeholder)}).on('focus',function(){this.value==EM.search_term_placeholder&&(this.value='')}).trigger('blur')),a('.em-search-form select[name=country]').on('change',function(){var c=a(this),b;a('.em-search select[name=state]').html('<option value="">'+EM.txt_loading+'</option>'),a('.em-search select[name=region]').html('<option value="">'+EM.txt_loading+'</option>'),a('.em-search select[name=town]').html('<option value="">'+EM.txt_loading+'</option>'),c.val()!=''?(c.closest('.em-search-location').find('.em-search-location-meta').slideDown(),b={action:'search_states',country:c.val(),return_html:!0},a('.em-search select[name=state]').load(EM.ajaxurl,b),b.action='search_regions',a('.em-search select[name=region]').load(EM.ajaxurl,b),b.action='search_towns',a('.em-search select[name=town]').load(EM.ajaxurl,b)):c.closest('.em-search-location').find('.em-search-location-meta').slideUp()}),a('.em-search-form select[name=region]').on('change',function(){a('.em-search select[name=state]').html('<option value="">'+EM.txt_loading+'</option>'),a('.em-search select[name=town]').html('<option value="">'+EM.txt_loading+'</option>');var b={action:'search_states',region:a(this).val(),country:a('.em-search-form select[name=country]').val(),return_html:!0};a('.em-search select[name=state]').load(EM.ajaxurl,b),b.action='search_towns',a('.em-search select[name=town]').load(EM.ajaxurl,b)}),a('.em-search-form select[name=state]').on('change',function(){a('.em-search select[name=town]').html('<option value="">'+EM.txt_loading+'</option>');var b={action:'search_towns',state:a(this).val(),region:a('.em-search-form select[name=region]').val(),country:a('.em-search-form select[name=country]').val(),return_html:!0};a('.em-search select[name=town]').load(EM.ajaxurl,b)}),a(document).on('submit','.em-search-form, .em-events-search-form',function(f){var c=a(this),b,e,d,g;if(this.em_search&&this.em_search.value==EM.txt_search&&(this.em_search.value=''),b=c.closest('.em-search-wrapper').find('.em-search-ajax'),b.length==0&&(b=a('.em-search-ajax')),b.length>0)return b.append('<div class="loading" id="em-loading"></div>'),e=c.find('.em-search-submit'),e.data('buttonText',e.val()).val(EM.txt_searching),d=e.children('img'),d.length>0&&d.attr('src',d.attr('src').replace('search-mag.png','search-loading.gif')),g=c.serialize(),a.ajax(EM.ajaxurl,{type:'POST',dataType:'html',data:g,success:function(h){e.val(e.data('buttonText')),d.length>0&&d.attr('src',d.attr('src').replace('search-loading.gif','search-mag.png')),b.replaceWith(h),c.find('input[name=em_search]').val()==''&&c.find('input[name=em_search]').val(EM.txt_search),b=c.closest('.em-search-wrapper').find('.em-search-ajax'),b.length==0&&(b=a('.em-search-ajax')),jQuery(document).triggerHandler('em_search_ajax',[g,b,f])}}),f.preventDefault(),!1}),a('.em-search-ajax').length>0&&a(document).on('click','.em-search-ajax a.page-numbers',function(f){var d=a(this),e=d.closest('.em-pagination').attr('data-em-ajax'),c=d.closest('.em-search-ajax'),g=c.parent(),h=d.attr('href').split('?'),b=h[1];return e!=''&&(b=b!=''?b+'&'+e:e),c.append('<div class="loading" id="em-loading"></div>'),a.ajax(EM.ajaxurl,{type:'POST',dataType:'html',data:b,success:function(a){c.replaceWith(a),c=g.find('.em-search-ajax'),jQuery(document).triggerHandler('em_search_ajax',[b,c,f])}}),f.preventDefault(),!1}),a('.events-table').on('click','.em-event-delete',function(){if(!confirm("Are you sure you want to delete?"))return!1;window.location.href=this.href}),a('#event-form #event-image-delete, #location-form #location-image-delete').on('click',function(){var b=a(this);b.is(':checked')?b.closest('.event-form-image, .location-form-image').find('#event-image-img, #location-image-img').hide():b.closest('.event-form-image, .location-form-image').find('#event-image-img, #location-image-img').show()}),a('#event-form.em-event-admin-recurring').on('submit',function(d){var c=a(this),b;c.find('input[name="event_reschedule"]').first().val()==1?(b=EM.event_reschedule_warning):c.find('input[name="event_recreate_tickets"]').first().val()==1?(b=EM.event_recurrence_bookings):(b=EM.event_recurrence_overwrite),confirmation=confirm(b),confirmation==!1&&d.preventDefault()}),a('.em-reschedule-trigger').on('click',function(c){c.preventDefault();var b=a(this);b.closest('.em-recurrence-reschedule').find(b.data('target')).removeClass('reschedule-hidden'),b.siblings('.em-reschedule-value').val(1),b.addClass('reschedule-hidden').siblings('a').removeClass('reschedule-hidden')}),a('.em-reschedule-cancel').on('click',function(c){c.preventDefault();var b=a(this);b.closest('.em-recurrence-reschedule').find(b.data('target')).addClass('reschedule-hidden'),b.siblings('.em-reschedule-value').val(0),b.addClass('reschedule-hidden').siblings('a').removeClass('reschedule-hidden')}),a("#em-tickets-form").length>0&&(a('#event-rsvp').on('click',function(b){this.checked?a('#event-rsvp-options').fadeIn():(confirmation=confirm(EM.disable_bookings_warning),confirmation==!1?b.preventDefault():a('#event-rsvp-options').hide())}),a('input#event-rsvp').is(":checked")?a("div#rsvp-data").fadeIn():a("div#rsvp-data").hide(),e=function(){a('#em-tickets-form table tbody tr.em-tickets-row').show(),a('#em-tickets-form table tbody tr.em-tickets-row-form').hide()},a('#em-recurrence-checkbox').length>0?a('#em-recurrence-checkbox').on('change',function(){a('#em-recurrence-checkbox').is(':checked')?(a('#em-tickets-form .ticket-dates-from-recurring, #em-tickets-form .ticket-dates-to-recurring, #event-rsvp-options .em-booking-date-recurring').show(),a('#em-tickets-form .ticket-dates-from-normal, #em-tickets-form .ticket-dates-to-normal, #event-rsvp-options .em-booking-date-normal, #em-tickets-form .hidden').hide()):(a('#em-tickets-form .ticket-dates-from-normal, #em-tickets-form .ticket-dates-to-normal, #event-rsvp-options .em-booking-date-normal').show(),a('#em-tickets-form .ticket-dates-from-recurring, #em-tickets-form .ticket-dates-to-recurring, #event-rsvp-options .em-booking-date-recurring, #em-tickets-form .hidden').hide())}).trigger('change'):a('#em-form-recurrence').length>0?(a('#em-tickets-form .ticket-dates-from-recurring, #em-tickets-form .ticket-dates-to-recurring, #event-rsvp-options .em-booking-date-recurring').show(),a('#em-tickets-form .ticket-dates-from-normal, #em-tickets-form .ticket-dates-to-normal, #event-rsvp-options .em-booking-date-normal, #em-tickets-form .hidden').hide()):a('#em-tickets-form .ticket-dates-from-recurring, #em-tickets-form .ticket-dates-to-recurring, #event-rsvp-options .em-booking-date-recurring, #em-tickets-form .hidden').hide(),a("#em-tickets-add").on('click',function(g){var d,f,b;g.preventDefault(),e(),d=a('#em-tickets-form table tbody'),f=d.length+1,b=d.first('.em-ticket-template').clone(!0).attr('id','em-ticket-'+f).removeClass('em-ticket-template').addClass('em-ticket').appendTo(a('#em-tickets-form table')),b.find('*[name]').each(function(c,b){b=a(b),b.attr('name',b.attr('name').replace('em_tickets[0]','em_tickets['+f+']'))}),b.show().find('.ticket-actions-edit').trigger('click'),b.find('.em-date-input-loc').datepicker('destroy').removeAttr('id'),b.find('.em-time-input').off().each(function(a,b){typeof this.em_timepickerObj=='object'&&this.em_timepicker('remove')}),em_setup_datepicker(b),em_setup_timepicker(b),a('html, body').animate({scrollTop:b.offset().top-30}),c()}),a(document).on('click','.ticket-actions-edit',function(c){c.preventDefault(),e();var b=a(this).closest('tbody');return b.find('tr.em-tickets-row').hide(),b.find('tr.em-tickets-row-form').fadeIn(),!1}),a(document).on('click','.ticket-actions-edited',function(d){var b,c;return d.preventDefault(),b=a(this).closest('tbody'),c=b.attr('id').replace('em-ticket-',''),b.find('.em-tickets-row').fadeIn(),b.find('.em-tickets-row-form').hide(),b.find('*[name]').each(function(g,d){var e,f;d=a(d),d.attr('name')=='ticket_start_pub'?b.find('span.ticket_start').text(d.val()):d.attr('name')=='ticket_end_pub'?b.find('span.ticket_end').text(d.val()):d.attr('name')=='em_tickets['+c+'][ticket_type]'?d.find(':selected').val()=='members'&&b.find('span.ticket_name').prepend('* '):d.attr('name')=='em_tickets['+c+'][ticket_start_recurring_days]'?(e=b.find('select.ticket-dates-from-recurring-when').val()=='before'?'-'+d.val():d.val(),d.val()!=''?(b.find('span.ticket_start_recurring_days').text(e),b.find('span.ticket_start_recurring_days_text, span.ticket_start_time').removeClass('hidden').show()):(b.find('span.ticket_start_recurring_days').text(' - '),b.find('span.ticket_start_recurring_days_text, span.ticket_start_time').removeClass('hidden').hide())):d.attr('name')=='em_tickets['+c+'][ticket_end_recurring_days]'?(e=b.find('select.ticket-dates-to-recurring-when').val()=='before'?'-'+d.val():d.val(),d.val()!=''?(b.find('span.ticket_end_recurring_days').text(e),b.find('span.ticket_end_recurring_days_text, span.ticket_end_time').removeClass('hidden').show()):(b.find('span.ticket_end_recurring_days').text(' - '),b.find('span.ticket_end_recurring_days_text, span.ticket_end_time').removeClass('hidden').hide())):(f=d.attr('name').replace('em_tickets['+c+'][','').replace(']','').replace('[]',''),b.find('.em-tickets-row .'+f).text(d.val()))}),a(document).triggerHandler('em_maps_tickets_edit',[b,c,!0]),a('html, body').animate({scrollTop:b.parent().offset().top-30}),!1}),a(document).on('change','.em-ticket-form select.ticket_type',function(c){var b=a(this);b.find('option:selected').val()=='members'?b.closest('.em-ticket-form').find('.ticket-roles').fadeIn():b.closest('.em-ticket-form').find('.ticket-roles').hide()}),a(document).on('click','.em-ticket-form .ticket-options-advanced',function(c){c.preventDefault();var b=a(this);b.hasClass('show')?(b.closest('.em-ticket-form').find('.em-ticket-form-advanced').fadeIn(),b.find('.show,.show-advanced').hide(),b.find('.hide,.hide-advanced').show()):(b.closest('.em-ticket-form').find('.em-ticket-form-advanced').hide(),b.find('.show,.show-advanced').show(),b.find('.hide,.hide-advanced').hide()),b.toggleClass('show')}),a('.em-ticket-form').each(function(){var b=!1,c=a(this);c.find('.em-ticket-form-advanced input[type="text"]').each(function(){this.value!=''&&(b=!0)}),c.find('.em-ticket-form-advanced input[type="checkbox"]:checked').length>0&&(b=!0),c.find('.em-ticket-form-advanced option:selected').each(function(){this.value!=''&&(b=!0)}),b&&c.find('.ticket-options-advanced').trigger('click')}),a(document).on('click','.ticket-actions-delete',function(e){var d,b;return e.preventDefault(),d=a(this),b=d.closest('tbody'),b.find('input.ticket_id').val()>0?(d.text('Deleting...'),a.getJSON(a(this).attr('href'),{em_ajax_action:'delete_ticket',id:b.find('input.ticket_id').val()},function(a){a.result?b.remove():(d.text('Delete'),alert(a.error))})):b.remove(),c(),!1}),a('#em-tickets-form.em-tickets-sortable table').sortable({items:'> tbody',placeholder:"em-ticket-sortable-placeholder",handle:'.ticket-status',helper:function(e,c){var b=a(c).clone().addClass('em-ticket-sortable-helper'),d=b.find('.em-tickets-row td').length;return b.children().remove(),b.append('<tr class="em-tickets-row"><td colspan="'+d+'" style="text-align:left; padding-left:15px;"><span class="dashicons dashicons-tickets-alt"></span></td></tr>'),b}}),c=function(){var b=a('#em-tickets-form table tbody.em-ticket');b.length==1?(b.find('.ticket-status').addClass('single'),a('#em-tickets-form.em-tickets-sortable table').sortable("option","disabled",!0)):(b.find('.ticket-status').removeClass('single'),a('#em-tickets-form.em-tickets-sortable table').sortable("option","disabled",!1))},c()),a('#em-bookings-table').length>0&&(a(document).on('click','#em-bookings-table .tablenav-pages a',function(){var d=a(this),b=d.parents('#em-bookings-table form.bookings-filter'),c=d.attr('href').match(/#[0-9]+/),e;return c!=null&&c.length>0?(e=c[0].replace('#',''),b.find('input[name=pno]').val(e)):b.find('input[name=pno]').val(1),b.trigger('submit'),!1}),k={modal:!0,autoOpen:!1,minWidth:500,height:'auto',buttons:[{text:EM.bookings_settings_save,click:function(d){var b,c;d.preventDefault(),b=a("#em-bookings-table form.bookings-filter [name=cols]").val(''),c=a('form#em-bookings-table-settings-form input.em-bookings-col-item'),a.each(c,function(c,a){a.value==1&&(b.val()!=''?b.val(b.val()+','+a.name):b.val(a.name))}),a('#em-bookings-table-settings').trigger('submitted'),a('#em-bookings-table form.bookings-filter').trigger('submit'),a(this).dialog('close')}}]},l={modal:!0,autoOpen:!1,minWidth:500,height:'auto',buttons:[{text:EM.bookings_export_save,click:function(b){a(this).children('form').trigger('submit'),a(this).dialog('close')}}]},a("#em-bookings-table-settings").length>0&&(a("#em-bookings-table-settings").dialog(k),a(document).on('click','#em-bookings-table-settings-trigger',function(b){b.preventDefault(),a("#em-bookings-table-settings").dialog('open')}),a("#em-bookings-table-export").dialog(l),a(document).on('click','#em-bookings-table-export-trigger',function(b){b.preventDefault(),a("#em-bookings-table-export").dialog('open')}),h=function(){a('#em-bookings-table-export-form input[name=show_tickets]').is(':checked')?(a('#em-bookings-table-export-form .em-bookings-col-item-ticket').show(),a('#em-bookings-table-export-form #em-bookings-export-cols-active .em-bookings-col-item-ticket input').val(1)):a('#em-bookings-table-export-form .em-bookings-col-item-ticket').hide().find('input').val(0)},a('#em-bookings-table form select').each(function(c,b){a(b).on('change',function(e){var b=a(this),c=a('#em-bookings-table-export-form input[name='+b.attr('name')+']'),d=b.find('option:selected');c.val(d.val())})}),h(),a('#em-bookings-table-export-form input[name=show_tickets]').on('click',h),a(".em-bookings-cols-sortable").sortable({connectWith:".em-bookings-cols-sortable",update:function(b,a){a.item.parents('ul#em-bookings-cols-active, ul#em-bookings-export-cols-active').length>0?a.item.addClass('ui-state-highlight').removeClass('ui-state-default').children('input').val(1):a.item.addClass('ui-state-default').removeClass('ui-state-highlight').children('input').val(0)}}).disableSelection(),b=!0),a(document).on('submit','#em-bookings-table form.bookings-filter',function(c){var b=a(this);return b.parents('#em-bookings-table').find('.table-wrap').first().append('<div id="em-loading" />'),a.post(EM.ajaxurl,b.serializeArray(),function(d){var c=b.parents('#em-bookings-table').first();c.replaceWith(d),a('#em-bookings-table-export input[name=scope]').val(c.find('select[name=scope]').val()),a('#em-bookings-table-export input[name=status]').val(c.find('select[name=status]').val()),jQuery(document).triggerHandler('em_bookings_filtered',[d,c,b])}),!1}),a(document).on('click','.em-bookings-approve,.em-bookings-reject,.em-bookings-unapprove,.em-bookings-delete',function(){var b=a(this),d,c;if(b.hasClass('em-bookings-delete'))if(!confirm(EM.booking_delete))return!1;return d=em_ajaxify(b.attr('href')),c=b.parents('td').first(),c.html(EM.txt_loading),c.load(d),!1})),a('.em_bookings_events_table').length>0&&(a(document).on('submit','.em_bookings_events_table form',function(d){var b=a(this),c=em_ajaxify(b.attr('action'));return b.parents('.em_bookings_events_table').find('.table-wrap').first().append('<div id="em-loading" />'),a.get(c,b.serializeArray(),function(a){b.parents('.em_bookings_events_table').first().replaceWith(a)}),!1}),a(document).on('click','.em_bookings_events_table .tablenav-pages a',function(){var b=a(this),c=em_ajaxify(b.attr('href'));return b.parents('.em_bookings_events_table').find('.table-wrap').first().append('<div id="em-loading" />'),a.get(c,function(a){b.parents('.em_bookings_events_table').first().replaceWith(a)}),!1})),a(document).on('click','a.em-booking-button',function(d){var b,c;return d.preventDefault(),b=a(this),b.text()!=EM.bb_booked&&a(this).text()!=EM.bb_booking&&(b.text(EM.bb_booking),c=b.attr('id').split('_'),a.ajax({url:EM.ajaxurl,dataType:'jsonp',data:{event_id:c[1],_wpnonce:c[2],action:'booking_add_one'},success:function(c,d,e,f){c.result?b.text(EM.bb_booked):b.text(EM.bb_error),c.message!=''&&alert(c.message),a(document).triggerHandler('em_booking_button_response',[c,b])},error:function(){b.text(EM.bb_error)}})),!1}),a(document).on('click','a.em-cancel-button',function(d){var b,c;return d.preventDefault(),b=a(this),b.text()!=EM.bb_cancelled&&b.text()!=EM.bb_canceling&&(b.text(EM.bb_canceling),c=b.attr('id').split('_'),a.ajax({url:EM.ajaxurl,dataType:'jsonp',data:{booking_id:c[1],_wpnonce:c[2],action:'booking_cancel'},success:function(a,c,d,e){a.result?b.text(EM.bb_cancelled):b.text(EM.bb_cancel_error)},error:function(){b.text(EM.bb_cancel_error)}})),!1}),a('.em-date-single, .em-date-range, #em-date-start').length>0&&(b=!0,em_setup_datepicker('body')),b&&em_load_jquery_css();function d(){var b,c;a(".interval-desc").hide(),b="-plural",(a('input#recurrence-interval').val()==1||a('input#recurrence-interval').val()=="")&&(b="-singular"),c="span#interval-"+a("select#recurrence-frequency").val()+b,a(c).show()}function i(){a('p.alternate-selector').hide(),a('p#'+a('select#recurrence-frequency').val()+"-selector").show()}function j(){a('input#event-recurrence').is(":checked")?(a("#event_recurrence_pattern").fadeIn(),a("#event-date-explanation").hide(),a("#recurrence-dates-explanation").show(),a("h3#recurrence-dates-title").show(),a("h3#event-date-title").hide()):(a("#event_recurrence_pattern").hide(),a("#recurrence-dates-explanation").hide(),a("#event-date-explanation").show(),a("h3#recurrence-dates-title").hide(),a("h3#event-date-title").show())}a("#recurrence-dates-explanation").hide(),a("#date-to-submit").hide(),a("#end-date-to-submit").hide(),a("#localised-date").show(),a("#localised-end-date").show(),a('#em-wrapper input.select-all').on('change',function(){a(this).is(':checked')?(a('input.row-selector').prop('checked',!0),a('input.select-all').prop('checked',!0)):(a('input.row-selector').prop('checked',!1),a('input.select-all').prop('checked',!1))}),d(),i(),j(),a('input#event-recurrence').on('change',j),a('input#recurrence-interval').on('keyup',d),a('select#recurrence-frequency').on('change',d),a('select#recurrence-frequency').on('change',i),(a('.em-location-map').length>0||a('.em-locations-map').length>0||a('#em-map').length>0||a('.em-search-geo').length>0)&&em_maps_load(),a('.em-location-types .em-location-types-select').on('change',function(){let b=a(this);if(b.val()==0)a('.em-location-type').hide();else{let c=b.find('option:selected').data('display-class');a('.em-location-type').hide(),a('.em-location-type.'+c).show(),c!='em-location-type-place'&&jQuery('#em-location-reset a').trigger('click')}b.data('active')!==''&&b.val()!==b.data('active')?(a('.em-location-type-delete-active-alert').hide(),a('.em-location-type-delete-active-alert').show()):a('.em-location-type-delete-active-alert').hide()}).trigger('change'),jQuery("div.em-location-data input#location-name").length>0&&(jQuery("div.em-location-data input#location-name").autocomplete({source:EM.locationajaxurl,minLength:2,focus:function(b,a){return jQuery("input#location-id").val(a.item.value),!1},select:function(b,a){return jQuery("input#location-id").val(a.item.id).trigger('change'),jQuery("input#location-name").val(a.item.value),jQuery('input#location-address').val(a.item.address),jQuery('input#location-town').val(a.item.town),jQuery('input#location-state').val(a.item.state),jQuery('input#location-region').val(a.item.region),jQuery('input#location-postcode').val(a.item.postcode),jQuery('input#location-latitude').val(a.item.latitude),jQuery('input#location-longitude').val(a.item.longitude),a.item.country==''?jQuery('select#location-country option:selected').removeAttr('selected'):jQuery('select#location-country option[value="'+a.item.country+'"]').attr('selected','selected'),jQuery('div.em-location-data input').css('background-color','#ccc').prop('readonly',!0),jQuery('div.em-location-data select').css('background-color','#ccc').css('color','#666666').prop('disabled',!0),jQuery('#em-location-reset').show(),jQuery('#em-location-search-tip').hide(),jQuery(document).triggerHandler('em_locations_autocomplete_selected',[b,a]),!1}}).data("ui-autocomplete")._renderItem=function(b,a){return html_val="<a>"+em_esc_attr(a.label)+'<br><span style="font-size:11px"><em>'+em_esc_attr(a.address)+', '+em_esc_attr(a.town)+"</em></span></a>",jQuery("<li></li>").data("item.autocomplete",a).append(html_val).appendTo(b)},jQuery('#em-location-reset a').on('click',function(){return jQuery('div.em-location-data input').css('background-color','#fff').val('').prop('readonly',!1),jQuery('div.em-location-data select').css('background-color','#fff').css('color','auto').prop('disabled',!1),jQuery('div.em-location-data option:selected').removeAttr('selected'),jQuery('input#location-id').val(''),jQuery('#em-location-reset').hide(),jQuery('#em-location-search-tip').show(),jQuery('#em-map').hide(),jQuery('#em-map-404').show(),typeof marker!='undefined'&&(marker.setPosition(new google.maps.LatLng(0,0)),infoWindow.close(),marker.setDraggable(!0)),!1}),jQuery('input#location-id').val()!='0'&&jQuery('input#location-id').val()!=''&&(jQuery('div.em-location-data input').css('background-color','#ccc').prop('readonly',!0),jQuery('div.em-location-data select').css('background-color','#ccc').css('color','#666666').prop('disabled',!0),jQuery('#em-location-reset').show(),jQuery('#em-location-search-tip').hide())),window.moment&&(f=function(b,a){return a=a.replace(/##T/g,Intl.DateTimeFormat().resolvedOptions().timeZone),a=a.replace(/#T/g,"GMT"+b.format('Z')),a=a.replace(/###t/g,b.utcOffset()*-60),a=a.replace(/##t/g,b.isDST()),a=a.replace(/#t/g,b.daysInMonth()),a},a('.em-date-momentjs').each(function(){var b=a(this),c=moment.unix(b.data('date-start')),d=f(c,c.format(b.data('date-format'))),g,h,e;b.data('date-start')!==b.data('date-end')?(g=moment.unix(b.data('date-end')),h=f(c,g.format(b.data('date-format'))),e=d+b.data('date-separator')+h):(e=d),b.text(e)}),g=function(d,e){let c=new Date(d*1e3),a=c.getMinutes();if(e==24){let b=c.getHours();return b=b<10?'0'+b:b,a=a<10?'0'+a:a,b+':'+a}let b=c.getHours()%12,f=b>=12?'PM':'AM';return b===0&&(b=12),a=a<10?'0'+a:a,b+':'+a+' '+f},a('.em-time-localjs').each(function(){var b=a(this),c=g(b.data('time'),b.data('time-format')),d;b.data('time-end')&&(d=b.data('time-separator')?b.data('time-separator'):' - ',c=c+d+g(b.data('time-end'),b.data('time-format'))),b.text(c)})),jQuery(document).triggerHandler('em_javascript_loaded')});function em_load_jquery_css(){if(EM.ui_css&&jQuery('link#jquery-ui-css').length==0){var a=document.createElement("link");a.id='jquery-ui-css',a.rel="stylesheet",a.href=EM.ui_css,document.body.appendChild(a)}}function em_setup_datepicker(b){b=jQuery(b);var a={altFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,firstDay:EM.firstDay,yearRange:'c-100:c+15'};EM.dateFormat&&(a.dateFormat=EM.dateFormat),EM.yearRange&&(a.yearRange=EM.yearRange),jQuery(document).triggerHandler('em_datepicker',a),dateDivs=b.find('.em-date-single, .em-date-range'),dateDivs.length>0&&(dateDivs.find('input.em-date-input-loc').each(function(f,b){var b=jQuery(b),c=b.nextAll('input.em-date-input').first(),d=c.val(),e;b.datepicker(a),b.datepicker('option','altField',c),d&&(e=jQuery.datepicker.formatDate(EM.dateFormat,jQuery.datepicker.parseDate('yy-mm-dd',d)),b.val(e),c.val(d)),b.on('change',function(){jQuery(this).val()==''&&jQuery(this).nextAll('.em-date-input').first().val('')})}),dateDivs.filter('.em-date-range').find('input.em-date-input-loc').each(function(c,a){if(a=jQuery(a),a.hasClass('em-date-start'))a.datepicker('option','onSelect',function(c){var b=jQuery(this),a=b.parents('.em-date-range').find('.em-date-end').first(),e=b.nextAll('input.em-date-input').first().val(),d=a.nextAll('input.em-date-input').first().val();b.trigger('em_datepicker_change'),e>d&&d!=''&&(a.datepicker("setDate",c),a.trigger('change').trigger('em_datepicker_change')),a.datepicker("option",'minDate',c)});else if(a.hasClass('em-date-end')){var b=a.parents('.em-date-range').find('.em-date-start').first();b.val()!=''&&a.datepicker('option','minDate',b.val())}}))}function em_setup_timepicker(a){a=jQuery(a);var b={step:15};b.timeFormat=EM.show24hours==1?'G:i':'g:i A',jQuery(document).triggerHandler('em_timepicker_options',b),a.find(".em-time-input").em_timepicker(b),a.find(".em-time-range input.em-time-start").each(function(c,b){var a=jQuery(b);a.data('oldTime',a.em_timepicker('getSecondsFromMidnight'))}).on('change',function(){var a=jQuery(this),b=a.nextAll('.em-time-end'),c,d,e;b.val()&&(c=a.data('oldTime'),d=(b.em_timepicker('getSecondsFromMidnight')-c)*1e3,e=a.em_timepicker('getSecondsFromMidnight'),b.em_timepicker('getSecondsFromMidnight')>=c&&b.em_timepicker('setTime',new Date(a.em_timepicker('getTime').getTime()+d)),a.data('oldTime',e))}),a.find(".event-form-when .em-time-range input.em-time-end").on('change',function(){var a=jQuery(this),b=a.prevAll('.em-time-start'),c=a.closest('.event-form-when'),e=c.find('.em-date-end').val(),d=c.find('.em-date-start').val();b.val()&&(b.em_timepicker('getTime')>a.em_timepicker('getTime')&&(d.length==0||e==d)?a.addClass("error"):a.removeClass("error"))}),a.find(".event-form-when .em-date-end").on('change',function(){jQuery(this).closest('.event-form-when').find('.em-time-end').trigger('change')}),a.find('.em-time-range input.em-time-all-day').on('change',function(){var a=jQuery(this);a.is(':checked')?a.siblings('.em-time-input').css('background-color','#ccc'):a.siblings('.em-time-input').css('background-color','#fff')}).trigger('change')}em_ajaxify=function(a){return a.search('em_ajax=0')!=-1?a=a.replace('em_ajax=0','em_ajax=1'):a.search(/\?/)!=-1?a=a+"&em_ajax=1":a=a+"?em_ajax=1",a},em_maps_loaded=!1,maps={},maps_markers={};function em_maps_load(){var a,b;em_maps_loaded||(jQuery('script#google-maps').length==0&&(typeof google!='object'||typeof google.maps!='object')?(a=document.createElement("script"),a.type="text/javascript",a.id="google-maps",b=EM.is_ssl?'https:':'http:',typeof EM.google_maps_api!='undefined'?a.src=b+'//maps.google.com/maps/api/js?v=quarterly&libraries=places&callback=em_maps&key='+EM.google_maps_api:a.src=b+'//maps.google.com/maps/api/js?v=quarterly&libraries=places&callback=em_maps',document.body.appendChild(a)):typeof google=='object'&&typeof google.maps=='object'&&!em_maps_loaded?em_maps():jQuery('script#google-maps').length>0&&jQuery(window).load(function(){em_maps_loaded||em_maps()}))}function em_maps_load_locations(b){var b=jQuery(b),a=b.attr('id').replace('em-locations-map-',''),c=jQuery.parseJSON(b.nextAll('.em-locations-map-coords').first().text());c==null&&(c=jQuery.parseJSON(jQuery('#em-locations-map-coords-'+a).text())),jQuery.getJSON(document.URL,c,function(e){var c,d,f;e.length>0?(c={mapTypeId:google.maps.MapTypeId.ROADMAP},typeof EM.google_map_id_styles=='object'&&typeof EM.google_map_id_styles[a]!='undefined'?(console.log(EM.google_map_id_styles[a]),c.styles=EM.google_map_id_styles[a]):typeof EM.google_maps_styles!='undefined'&&(c.styles=EM.google_maps_styles),jQuery(document).triggerHandler('em_maps_locations_map_options',c),d={},jQuery(document).triggerHandler('em_maps_location_marker_options',d),maps[a]=new google.maps.Map(b[0],c),maps_markers[a]=[],f=new google.maps.LatLngBounds,jQuery.map(e,function(b,j){var e,g,h,c,i;b.location_latitude==0&&b.location_longitude==0||(e=parseFloat(b.location_latitude),g=parseFloat(b.location_longitude),h=new google.maps.LatLng(e,g),jQuery.extend(d,{position:h,map:maps[a]}),c=new google.maps.Marker(d),maps_markers[a].push(c),c.setTitle(b.location_name),i='<div class="em-map-balloon"><div id="em-map-balloon-'+a+'" class="em-map-balloon-content">'+b.location_balloon+'</div></div>',em_map_infobox(c,i,maps[a]),f.extend(new google.maps.LatLng(e,g)))}),maps[a].fitBounds(f),jQuery(document).triggerHandler('em_maps_locations_hook',[maps[a],e,a,maps_markers[a]])):(b.children().first().html('No locations found'),jQuery(document).triggerHandler('em_maps_locations_hook_not_found',[b]))})}function em_maps_load_location(c){var a,b,d;c=jQuery(c),a=c.attr('id').replace('em-location-map-',''),em_LatLng=new google.maps.LatLng(jQuery('#em-location-map-coords-'+a+' .lat').text(),jQuery('#em-location-map-coords-'+a+' .lng').text()),b={zoom:14,center:em_LatLng,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1,gestureHandling:'cooperative'},typeof EM.google_map_id_styles=='object'&&typeof EM.google_map_id_styles[a]!='undefined'?(console.log(EM.google_map_id_styles[a]),b.styles=EM.google_map_id_styles[a]):typeof EM.google_maps_styles!='undefined'&&(b.styles=EM.google_maps_styles),jQuery(document).triggerHandler('em_maps_location_map_options',b),maps[a]=new google.maps.Map(document.getElementById('em-location-map-'+a),b),d={position:em_LatLng,map:maps[a]},jQuery(document).triggerHandler('em_maps_location_marker_options',d),maps_markers[a]=new google.maps.Marker(d),infoWindow=new google.maps.InfoWindow({content:jQuery('#em-location-map-info-'+a+' .em-map-balloon').get(0)}),infoWindow.open(maps[a],maps_markers[a]),maps[a].panBy(40,-70),jQuery(document).triggerHandler('em_maps_location_hook',[maps[a],infoWindow,maps_markers[a],a]),jQuery(window).on('resize',function(b){google.maps.event.trigger(maps[a],"resize"),maps[a].setCenter(maps_markers[a].getPosition()),maps[a].panBy(40,-70)})}jQuery(document).on('em_search_ajax',function(b,c,a){em_maps_loaded&&(a.find('.em-location-map').each(function(b,a){em_maps_load_location(a)}),a.find('.em-locations-map').each(function(b,a){em_maps_load_locations(a)}))});function em_maps(){var a,b,c,f,d,e,g;jQuery('.em-location-map').each(function(b,a){em_maps_load_location(a)}),jQuery('.em-locations-map').each(function(b,a){em_maps_load_locations(a)}),jQuery('select#location-select-id, input#location-address').length>0&&(c=function(){var d=jQuery('#location-latitude').val(),e=jQuery('#location-longitude').val(),f,c;d==0&&e==0?(jQuery('#em-map').hide(),jQuery('#em-map-404').show()):(f=new google.maps.LatLng(d,e),b.setPosition(f),c=jQuery('input#location-name').length>0?jQuery('input#location-name').val():jQuery('input#title').val(),c=em_esc_attr(c),b.setTitle(c),jQuery('#em-map').show(),jQuery('#em-map-404').hide(),google.maps.event.trigger(a,'resize'),a.setCenter(f),a.panBy(40,-55),infoWindow.setContent('<div id="location-balloon-content"><strong>'+c+'</strong><br>'+em_esc_attr(jQuery('#location-address').val())+'<br>'+em_esc_attr(jQuery('#location-town').val())+'</div>'),infoWindow.open(a,b),jQuery(document).triggerHandler('em_maps_location_hook',[a,infoWindow,b,0]))},f=function(c){jQuery('#em-map').length>0&&jQuery.getJSON(document.URL,{em_ajax_action:'get_location',id:c},function(c){c.location_latitude!=0&&c.location_longitude!=0?(loc_latlng=new google.maps.LatLng(c.location_latitude,c.location_longitude),b.setPosition(loc_latlng),b.setTitle(c.location_name),b.setDraggable(!1),jQuery('#em-map').show(),jQuery('#em-map-404').hide(),a.setCenter(loc_latlng),a.panBy(40,-55),infoWindow.setContent('<div id="location-balloon-content">'+c.location_balloon+'</div>'),infoWindow.open(a,b),google.maps.event.trigger(a,'resize'),jQuery(document).triggerHandler('em_maps_location_hook',[a,infoWindow,b,0])):(jQuery('#em-map').hide(),jQuery('#em-map-404').show())})},jQuery('#location-select-id, input#location-id').on('change',function(){f(jQuery(this).val())}),jQuery('#location-name, #location-town, #location-address, #location-state, #location-postcode, #location-country').on('change',function(){var b,a;if(jQuery(this).prop('readonly')===!0)return;if(b=[jQuery('#location-address').val(),jQuery('#location-town').val(),jQuery('#location-state').val(),jQuery('#location-postcode').val()],a='',jQuery.each(b,function(c,b){b!=''&&(a=a==''?a+b:a+', '+b)}),a=='')return jQuery('#em-map').hide(),jQuery('#em-map-404').show(),!1;jQuery('#location-country option:selected').val()!=0&&(a=a==''?a+jQuery('#location-country option:selected').text():a+', '+jQuery('#location-country option:selected').text()),a!=''&&jQuery('#em-map').length>0&&g.geocode({address:a},function(a,b){b==google.maps.GeocoderStatus.OK&&(jQuery('#location-latitude').val(a[0].geometry.location.lat()),jQuery('#location-longitude').val(a[0].geometry.location.lng())),c()})}),jQuery('#em-map').length>0&&(d=new google.maps.LatLng(0,0),e={zoom:14,center:d,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1,gestureHandling:'cooperative'},typeof EM.google_maps_styles!='undefined'&&(e.styles=EM.google_maps_styles),a=new google.maps.Map(document.getElementById('em-map'),e),b=new google.maps.Marker({position:d,map:a,draggable:!0}),infoWindow=new google.maps.InfoWindow({content:''}),g=new google.maps.Geocoder,google.maps.event.addListener(infoWindow,'domready',function(){document.getElementById('location-balloon-content').parentNode.style.overflow='',document.getElementById('location-balloon-content').parentNode.parentNode.style.overflow=''}),google.maps.event.addListener(b,'dragend',function(){var c=b.getPosition();jQuery('#location-latitude').val(c.lat()),jQuery('#location-longitude').val(c.lng()),a.setCenter(c),a.panBy(40,-55)}),jQuery('#location-select-id').length>0?jQuery('#location-select-id').trigger('change'):c(),jQuery(document).triggerHandler('em_map_loaded',[a,infoWindow,b])),jQuery(window).on('resize',function(c){google.maps.event.trigger(a,"resize"),a.setCenter(b.getPosition()),a.panBy(40,-55)})),em_maps_loaded=!0,jQuery(document).triggerHandler('em_maps_loaded')}function em_map_infobox(a,c,d){var b=new google.maps.InfoWindow({content:c});google.maps.event.addListener(a,'click',function(){infoWindow&&infoWindow.close(),infoWindow=b,b.open(d,a)})}function em_esc_attr(a){return typeof a!='string'?'':a.replace(/</gi,'&lt;').replace(/>/gi,'&gt;')}(function(){"use strict";var a,f,e,h,c;function b(a){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?b=function(a){return typeof a}:b=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},b(a)}function l(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function j(d,c){for(var b=0,a;b<c.length;b++)a=c[b],a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}function p(a,b,c){return b&&j(a.prototype,b),c&&j(a,c),a}function o(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function i(a,d){var b=Object.keys(a),c;return Object.getOwnPropertySymbols&&(c=Object.getOwnPropertySymbols(a),d&&(c=c.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),b.push.apply(b,c)),b}function d(c){for(var a=1,b;a<arguments.length;a++)b=arguments[a]!=null?arguments[a]:{},a%2?i(Object(b),!0).forEach(function(a){o(c,a,b[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(b)):i(Object(b)).forEach(function(a){Object.defineProperty(c,a,Object.getOwnPropertyDescriptor(b,a))});return c}function n(a,c){if(!a)return;if(typeof a=="string")return k(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);if(b==="Object"&&a.constructor&&(b=a.constructor.name),b==="Map"||b==="Set")return Array.from(b);if(b==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return k(a,c)}function k(c,a){(a==null||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}function g(a){var c,d,b,e,f,g;if(typeof Symbol=="undefined"||a[Symbol.iterator]==null){if(Array.isArray(a)||(a=n(a)))return c=0,d=function(){},{s:d,n:function(){return c>=a.length?{done:!0}:{done:!1,value:a[c++]}},e:function(a){throw a},f:d};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return e=!0,f=!1,{s:function(){b=a[Symbol.iterator]()},n:function(){var a=b.next();return e=a.done,a},e:function(a){f=!0,g=a},f:function(){try{!e&&b.return!=null&&b.return()}finally{if(f)throw g}}}}a=86400,f=function(b,a){var c,d;return b===null?null:typeof a.step!="number"?b:(c=b%(a.step*60),d=a.minTime||0,c-=d%(a.step*60),c>=a.step*30?b+=a.step*60-c:b-=c,m(b,a))};function m(b,c){return b==a&&c.show2400?b:b%a}e={appendTo:"body",className:null,closeOnWindowScroll:!1,disableTextInput:!1,disableTimeRanges:[],disableTouchKeyboard:!1,durationTime:null,forceRoundTime:!1,lang:{},listWidth:null,maxTime:null,minTime:null,noneOption:!1,orientation:"l",roundingFunction:f,scrollDefault:null,selectOnBlur:!1,show2400:!1,showDuration:!1,showOn:["click","focus"],showOnFocus:!0,step:30,stopScrollPropagation:!1,timeFormat:"g:ia",typeaheadHighlight:!0,useSelect:!1,wrapHours:!0},h={am:"am",pm:"pm",AM:"AM",PM:"PM",decimal:".",mins:"mins",hr:"hr",hrs:"hrs"},c=function(){function c(a){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f;l(this,c),this._handleFormatValue=this._handleFormatValue.bind(this),this._handleKeyUp=this._handleKeyUp.bind(this),this.targetEl=a,f=c.extractAttrOptions(a,Object.keys(e)),this.settings=this.parseSettings(d(d(d({},e),b),f))}return p(c,[{key:"hideMe",value:function(){if(this.settings.useSelect){this.targetEl.blur();return}if(!this.list||!c.isVisible(this.list))return;this.settings.selectOnBlur&&this._selectValue(),this.list.hide();var a=new CustomEvent("hideTimepicker");this.targetEl.dispatchEvent(a)}},{key:"_findRow",value:function(a){var b;return!(!a&&a!==0)&&(!(b=!1,a=this.settings.roundingFunction(a,this.settings),!this.list)&&(this.list.find("li").each(function(e,c){var d=Number.parseInt(c.dataset.time);if(Number.isNaN(d))return;if(d==a)return b=c,!1}),b))}},{key:"_hideKeyboard",value:function(){return(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&this.settings.disableTouchKeyboard}},{key:"_setTimeValue",value:function(b,c){var a,f,e,d,g;return this.targetEl.nodeName==="INPUT"&&((b!==null||this.targetEl.value!="")&&(this.targetEl.value=b),a=this,f=a.settings,f.useSelect&&c!="select"&&a.list&&a.list.val(a._roundAndFormatTime(a.time2int(b)))),e=new Event("selectTime"),this.selectedValue!=b?(this.selectedValue=b,d=new Event("changeTime"),g=new CustomEvent("change",{detail:"em_timepicker"}),c=="select"?(this.targetEl.dispatchEvent(e),this.targetEl.dispatchEvent(d),this.targetEl.dispatchEvent(g)):["error","initial"].indexOf(c)==-1&&this.targetEl.dispatchEvent(d),!0):(["error","initial"].indexOf(c)==-1&&this.targetEl.dispatchEvent(e),!1)}},{key:"_getTimeValue",value:function(){return this.targetEl.nodeName==="INPUT"?this.targetEl.value:this.selectedValue}},{key:"_selectValue",value:function(){var b=this,f=b.settings,e=b.list,c=e.find(".ui-em_timepicker-selected"),a,d;return!c.hasClass("ui-em_timepicker-disabled")&&(!c.length||(a=c.get(0).dataset.time,a&&(d=Number.parseInt(a),Number.isNaN(d)||(a=d)),a!==null&&(typeof a!="string"&&(a=b._int2time(a)),b._setTimeValue(a,"select")),!0))}},{key:"time2int",value:function(b){var i,n,d,e,c,f,j,k,l,m,g,h;if(b===""||b===null||b===void 0)return null;if(b instanceof Date)return b.getHours()*3600+b.getMinutes()*60+b.getSeconds();if(typeof b!="string")return b;if(b=b.toLowerCase().replace(/[\s\.]/g,""),(b.slice(-1)=="a"||b.slice(-1)=="p")&&(b+="m"),i=/^(([^0-9]*))?([0-9]?[0-9])(([0-5][0-9]))?(([0-5][0-9]))?(([^0-9]*))$/,n=b.match(/\W/),n&&(i=/^(([^0-9]*))?([0-9]?[0-9])(\W+([0-5][0-9]?))?(\W+([0-5][0-9]))?(([^0-9]*))$/),d=b.match(i),!d)return null;if(e=parseInt(d[3]*1,10),c=d[2]||d[9],f=e,j=d[5]*1||0,k=d[7]*1||0,!c&&d[3].length==2&&d[3][0]=="0"&&(c="am"),e<=12&&c)c=c.trim(),l=c==this.settings.lang.pm||c==this.settings.lang.PM,e==12?f=l?12:0:f=e+(l?12:0);else if(m=e*3600+j*60+k,m>=a+(this.settings.show2400?1:0)){if(this.settings.wrapHours===!1)return null;f=e%24}return g=f*3600+j*60+k,e<12&&!c&&this.settings._twelveHourTime&&this.settings.scrollDefault&&(h=g-this.settings.scrollDefault(),h<0&&h>=a/-2&&(g=(g+a/2)%a)),g}},{key:"parseSettings",value:function(a){var c=this,e,b;if(a.lang=d(d({},h),a.lang),this.settings=a,a.minTime&&(a.minTime=this.time2int(a.minTime)),a.maxTime&&(a.maxTime=this.time2int(a.maxTime)),a.listWidth&&(a.listWidth=this.time2int(a.listWidth)),a.durationTime&&typeof a.durationTime!="function"&&(a.durationTime=this.time2int(a.durationTime)),a.scrollDefault=="now"?a.scrollDefault=function(){return a.roundingFunction(c.time2int(new Date),a)}:a.scrollDefault&&typeof a.scrollDefault!="function"?(e=a.scrollDefault,a.scrollDefault=function(){return a.roundingFunction(c.time2int(e),a)}):a.minTime&&(a.scrollDefault=function(){return a.roundingFunction(a.minTime,a)}),typeof a.timeFormat=="string"&&a.timeFormat.match(/[gh]/)&&(a._twelveHourTime=!0),a.showOnFocus===!1&&a.showOn.indexOf("focus")!=-1&&a.showOn.splice(a.showOn.indexOf("focus"),1),a.disableTimeRanges||(a.disableTimeRanges=[]),a.disableTimeRanges.length>0){for(b in a.disableTimeRanges)a.disableTimeRanges[b]=[this.time2int(a.disableTimeRanges[b][0]),this.time2int(a.disableTimeRanges[b][1])];a.disableTimeRanges=a.disableTimeRanges.sort(function(a,b){return a[0]-b[0]});for(b=a.disableTimeRanges.length-1;b>0;b--)a.disableTimeRanges[b][0]<=a.disableTimeRanges[b-1][1]&&(a.disableTimeRanges[b-1]=[Math.min(a.disableTimeRanges[b][0],a.disableTimeRanges[b-1][0]),Math.max(a.disableTimeRanges[b][1],a.disableTimeRanges[b-1][1])],a.disableTimeRanges.splice(b,1))}return a}},{key:"_disableTextInputHandler",value:function(a){switch(a.keyCode){case 13:case 9:return;default:a.preventDefault()}}},{key:"_int2duration",value:function(e,f){e=Math.abs(e);var c=Math.round(e/60),a=[],d,b;return c<60?a=[c,this.settings.lang.mins]:(d=Math.floor(c/60),b=c%60,f==30&&b==30&&(d+=this.settings.lang.decimal+5),a.push(d),a.push(d==1?this.settings.lang.hr:this.settings.lang.hrs),f!=30&&b&&(a.push(b),a.push(this.settings.lang.mins))),a.join(" ")}},{key:"_roundAndFormatTime",value:function(a){if(a=this.settings.roundingFunction(a,this.settings),a!==null)return this._int2time(a)}},{key:"_int2time",value:function(g){var e,f,j,d,c,b,i,h;if(typeof g!="number")return null;if(e=parseInt(g%60),f=parseInt(g/60%60),j=parseInt(g/(60*60)%24),d=new Date(1970,0,2,j,f,e,0),isNaN(d.getTime()))return null;if(typeof this.settings.timeFormat=="function")return this.settings.timeFormat(d);c="";for(h=0;h<this.settings.timeFormat.length;h++)switch(i=this.settings.timeFormat.charAt(h),i){case"a":c+=d.getHours()>11?this.settings.lang.pm:this.settings.lang.am;break;case"A":c+=d.getHours()>11?this.settings.lang.PM:this.settings.lang.AM;break;case"g":b=d.getHours()%12,c+=b===0?"12":b;break;case"G":b=d.getHours(),g===a&&(b=this.settings.show2400?24:0),c+=b;break;case"h":b=d.getHours()%12,b!==0&&b<10&&(b="0"+b),c+=b===0?"12":b;break;case"H":b=d.getHours(),g===a&&(b=this.settings.show2400?24:0),c+=b>9?b:"0"+b;break;case"i":f=d.getMinutes(),c+=f>9?f:"0"+f;break;case"s":e=d.getSeconds(),c+=e>9?e:"0"+e;break;case"\\":h++,c+=this.settings.timeFormat.charAt(h);break;default:c+=i}return c}},{key:"_setSelected",value:function(){var a=this.list,d,b,c,e,f,g,h;if(a.find("li").removeClass("ui-em_timepicker-selected"),d=this.time2int(this._getTimeValue()),d===null)return;b=this._findRow(d),b&&(c=b.getBoundingClientRect(),e=a.get(0).getBoundingClientRect(),f=c.top-e.top,(f+c.height>e.height||f<0)&&(g=a.scrollTop()+(c.top-e.top)-c.height,a.scrollTop(g)),h=Number.parseInt(b.dataset.time),(this.settings.forceRoundTime||h===d)&&b.classList.add("ui-em_timepicker-selected"))}},{key:"_isFocused",value:function(a){return a===document.activeElement}},{key:"_handleFormatValue",value:function(a){if(a&&a.detail=="em_timepicker")return;this._formatValue(a)}},{key:"_formatValue",value:function(m,e){var b,a,l,d,c,j,h,f,i,k;if(this.targetEl.value===""){this._setTimeValue(null,e);return}if(this._isFocused(this.targetEl)&&(!m||m.type!="change"))return;if(b=this.settings,a=this.time2int(this.targetEl.value),a===null){l=new CustomEvent("timeFormatError"),this.targetEl.dispatchEvent(l);return}d=!1,b.minTime!==null&&b.maxTime!==null&&(a<b.minTime||a>b.maxTime)&&(d=!0),c=g(b.disableTimeRanges);try{for(c.s();!(j=c.n()).done;)if(h=j.value,a>=h[0]&&a<h[1]){d=!0;break}}catch(a){c.e(a)}finally{c.f()}b.forceRoundTime&&(f=b.roundingFunction(a,b),f!=a&&(a=f,e=null)),i=this._int2time(a),d?(this._setTimeValue(i),k=new CustomEvent("timeRangeError"),this.targetEl.dispatchEvent(k)):this._setTimeValue(i,e)}},{key:"_generateNoneElement",value:function(c,g){var e,f,d,a;return b(c)=="object"?(e=c.label,f=c.className,d=c.value):typeof c=="string"?(e=c,d=""):$.error("Invalid noneOption value"),g?(a=document.createElement("option"),a.value=d):(a=document.createElement("li"),a.dataset.time=String(d)),a.innerText=e,a.classList.add(f),a}},{key:"_handleKeyUp",value:function(a){if(!this.list||!c.isVisible(this.list)||this.settings.disableTextInput)return!0;if(a.type==="paste"||a.type==="cut"){setTimeout(function(){this.settings.typeaheadHighlight?this._setSelected():this.list.hide()},0);return}switch(a.keyCode){case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 65:case 77:case 80:case 186:case 8:case 46:this.settings.typeaheadHighlight?this._setSelected():this.list.hide();break}}}],[{key:"extractAttrOptions",value:function(c,f){var d={},a=g(f),e,b;try{for(a.s();!(e=a.n()).done;)b=e.value,b in c.dataset&&(d[b]=c.dataset[b])}catch(b){a.e(b)}finally{a.f()}return d}},{key:"isVisible",value:function(b){var a=b[0];return a.offsetWidth>0&&a.offsetHeight>0}},{key:"hideAll",value:function(){var a=g(document.getElementsByClassName("ui-em_timepicker-input")),b,d,c;try{for(a.s();!(b=a.n()).done;)d=b.value,c=d.em_timepickerObj,c&&c.hideMe()}catch(b){a.e(b)}finally{a.f()}}}]),c}(),function(a){(typeof exports=="undefined"?"undefined":b(exports))==="object"&&exports&&(typeof module=="undefined"?"undefined":b(module))==="object"&&module&&module.exports===exports?a(require("jquery")):typeof define=="function"&&define.amd?define(["jquery"],a):a(jQuery)}(function(d){var j={},g={init:function(a){return this.each(function(){var b=d(this),e=new c(this,a),f=e.settings,i;if(j=f.lang,this.em_timepickerObj=e,b.addClass("ui-em_timepicker-input"),f.useSelect)h(b);else{if(b.prop("autocomplete","off"),f.showOn)for(i in f.showOn)b.on(f.showOn[i]+".em_timepicker",g.show);b.on("change.em_timepicker",e._handleFormatValue),b.on("keydown.em_timepicker",k),b.on("keyup.em_timepicker",e._handleKeyUp),f.disableTextInput&&b.on("keydown.em_timepicker",e._disableTextInputHandler),b.on("cut.em_timepicker",e._handleKeyUp),b.on("paste.em_timepicker",e._handleKeyUp),e._formatValue(null,"initial")}})},show:function(l){var b=d(this),f=b[0].em_timepickerObj,e=f.settings,a,j,k,g,m,n;if(l&&l.preventDefault(),e.useSelect){f.list.trigger("focus");return}if(f._hideKeyboard()&&b.trigger("blur"),a=f.list,b.prop("readonly"))return;if((!a||a.length===0||typeof e.durationTime=="function")&&(h(b),a=f.list),c.isVisible(a))return;return b.is("input")&&(f.selectedValue=b.val()),f._setSelected(),c.hideAll(),typeof e.listWidth=="number"&&a.width(b.outerWidth()*e.listWidth),a.show(),j={},e.orientation.match(/r/)?j.left=b.offset().left+b.outerWidth()-a.outerWidth()+parseInt(a.css("marginLeft").replace("px",""),10):e.orientation.match(/l/)?j.left=b.offset().left+parseInt(a.css("marginLeft").replace("px",""),10):e.orientation.match(/c/)&&(j.left=b.offset().left+(b.outerWidth()-a.outerWidth())/2+parseInt(a.css("marginLeft").replace("px",""),10)),e.orientation.match(/t/)?k="t":e.orientation.match(/b/)?k="b":b.offset().top+b.outerHeight(!0)+a.outerHeight()>d(window).height()+d(window).scrollTop()?k="t":k="b",k=="t"?(a.addClass("ui-em_timepicker-positioned-top"),j.top=b.offset().top-a.outerHeight()+parseInt(a.css("marginTop").replace("px",""),10)):(a.removeClass("ui-em_timepicker-positioned-top"),j.top=b.offset().top+b.outerHeight()+parseInt(a.css("marginTop").replace("px",""),10)),a.offset(j),g=a.find(".ui-em_timepicker-selected"),g.length||(m=f.time2int(f._getTimeValue()),m!==null?g=d(f._findRow(m)):e.scrollDefault&&(g=d(f._findRow(e.scrollDefault())))),(!g.length||g.hasClass("ui-em_timepicker-disabled"))&&(g=a.find("li:not(.ui-em_timepicker-disabled):first")),g&&g.length?(n=a.scrollTop()+g.position().top-g.outerHeight(),a.scrollTop(n)):a.scrollTop(0),e.stopScrollPropagation&&d(document).on("wheel.ui-em_timepicker",".ui-em_timepicker-wrapper",function(a){a.preventDefault();var b=d(this).scrollTop();d(this).scrollTop(b+a.originalEvent.deltaY)}),d(document).on("mousedown.ui-em_timepicker",i),d(window).on("resize.ui-em_timepicker",i),e.closeOnWindowScroll&&d(document).on("scroll.ui-em_timepicker",i),b.trigger("showTimepicker"),this},hide:function(d){var a=this[0].em_timepickerObj;return a&&a.hideMe(),c.hideAll(),this},option:function(a,c){if(typeof a=="string"&&typeof c=="undefined"){var e=this[0].em_timepickerObj;return e.settings[a]}return this.each(function(){var g=d(this),f=g[0].em_timepickerObj,e=f.settings,i=f.list;b(a)=="object"?e=d.extend(e,a):typeof a=="string"&&(e[a]=c),e=f.parseSettings(e),f.settings=e,f._formatValue({type:"change"},"initial"),i&&(i.remove(),f.list=null),e.useSelect&&h(g)})},getSecondsFromMidnight:function(){var a=this[0].em_timepickerObj;return a.time2int(a._getTimeValue())},getTime:function(c){var d=this[0].em_timepickerObj,e=d._getTimeValue(),b,a;return e?(b=d.time2int(e),b===null)?null:(c||(c=new Date),a=new Date(c),a.setHours(b/3600),a.setMinutes(b%3600/60),a.setSeconds(b%60),a.setMilliseconds(0),a):null},isVisible:function(){var a=this[0].em_timepickerObj;return!!(a&&a.list&&c.isVisible(a.list))},setTime:function(b){var a=this[0].em_timepickerObj,d=a.settings,c;return d.forceRoundTime?(c=a._roundAndFormatTime(a.time2int(b))):(c=a._int2time(a.time2int(b))),b&&c===null&&d.noneOption&&(c=b),a._setTimeValue(c,"initial"),a._formatValue({type:"change"},"initial"),a&&a.list&&a._setSelected(),this},remove:function(){var a=this,b,c;if(!a.hasClass("ui-em_timepicker-input"))return;return b=a[0].em_timepickerObj,c=b.settings,a.removeAttr("autocomplete","off"),a.removeClass("ui-em_timepicker-input"),a.removeData("em_timepicker-obj"),a.off(".em_timepicker"),b.list&&b.list.remove(),c.useSelect&&a.show(),b.list=null,this}};function h(h){var e=h[0].em_timepickerObj,c=e.list,b=e.settings,j,k,q,z,u,t,p,o,n,y,s,x,m,r,i,v,w,l;if(c&&c.length&&(c.remove(),e.list=null),b.useSelect?(c=d("<select></select>",{class:"ui-em_timepicker-select"}),h.attr("name")&&c.attr("name","ui-em_timepicker-"+h.attr("name")),j=c):(c=d("<ul></ul>",{class:"ui-em_timepicker-list"}),j=d("<div></div>",{class:"ui-em_timepicker-wrapper",tabindex:-1}),j.css({display:"none",position:"absolute"}).append(c)),b.noneOption)if(b.noneOption===!0&&(b.noneOption=b.useSelect?"Time...":"None"),d.isArray(b.noneOption)){for(k in b.noneOption)parseInt(k,10)==k&&(q=e._generateNoneElement(b.noneOption[k],b.useSelect),c.append(q))}else q=e._generateNoneElement(b.noneOption,b.useSelect),c.append(q);b.className&&j.addClass(b.className),(b.minTime!==null||b.durationTime!==null)&&b.showDuration&&(z=typeof b.step=="function"?"function":b.step,j.addClass("ui-em_timepicker-with-duration"),j.addClass("ui-em_timepicker-step-"+b.step)),u=b.minTime,typeof b.durationTime=="function"?u=e.time2int(b.durationTime()):b.durationTime!==null&&(u=b.durationTime),t=b.minTime!==null?b.minTime:0,p=b.maxTime!==null?b.maxTime:t+a-1,p<t&&(p+=a),p===a-1&&d.type(b.timeFormat)==="string"&&b.show2400&&(p=a),o=b.disableTimeRanges,n=0,y=o.length,s=b.step,typeof s!="function"&&(s=function(){return b.step});for(k=t,x=0;k<=p;x++,k+=s(x)*60)m=k,r=e._int2time(m),b.useSelect?(i=d("<option></option>",{value:r}),i.text(r)):(i=d("<li></li>"),i.addClass(m%a<a/2?"ui-em_timepicker-am":"ui-em_timepicker-pm"),i.attr("data-time",f(m,b)),i.text(r)),(b.minTime!==null||b.durationTime!==null)&&b.showDuration&&(v=e._int2duration(k-u,b.step),b.useSelect?i.text(i.text()+" ("+v+")"):(w=d("<span></span>",{class:"ui-em_timepicker-duration"}),w.text(" ("+v+")"),i.append(w))),n<y&&(m>=o[n][1]&&(n+=1),o[n]&&m>=o[n][0]&&m<o[n][1]&&(b.useSelect?i.prop("disabled",!0):i.addClass("ui-em_timepicker-disabled"))),c.append(i);j.data("em_timepicker-input",h),e.list=j,b.useSelect?(h.val()&&c.val(e._roundAndFormatTime(e.time2int(h.val()))),c.on("focus",function(){d(this).data("em_timepicker-input").trigger("showTimepicker")}),c.on("blur",function(){d(this).data("em_timepicker-input").trigger("hideTimepicker")}),c.on("change",function(){e._setTimeValue(d(this).val(),"select")}),e._setTimeValue(c.val(),"initial"),h.hide().after(c)):(l=b.appendTo,typeof l=="string"?l=d(l):typeof l=="function"&&(l=l(h)),l.append(j),e._setSelected(),c.on("mousedown click","li",function(a){h.off("focus.em_timepicker"),h.on("focus.em_timepicker-ie-hack",function(){h.off("focus.em_timepicker-ie-hack"),h.on("focus.em_timepicker",g.show)}),e._hideKeyboard()||h[0].focus(),c.find("li").removeClass("ui-em_timepicker-selected"),d(this).addClass("ui-em_timepicker-selected"),e._selectValue()&&(h.trigger("hideTimepicker"),c.on("mouseup.em_timepicker click.em_timepicker","li",function(a){c.off("mouseup.em_timepicker click.em_timepicker"),j.hide()}))}))}function i(a){if(a.target==window)return;var b=d(a.target);if(b.closest(".ui-em_timepicker-input").length||b.closest(".ui-em_timepicker-wrapper").length)return;c.hideAll(),d(document).off(".ui-em_timepicker"),d(window).off(".ui-em_timepicker")}function k(f){var h=d(this),e=h[0].em_timepickerObj,b=e.list,a;if(!b||!c.isVisible(b))if(f.keyCode==40)g.show.call(h.get(0)),b=e.list,e._hideKeyboard()||h.trigger("focus");else return!0;switch(f.keyCode){case 13:return e._selectValue()&&(e._formatValue({type:"change"}),e.hideMe()),f.preventDefault(),!1;case 38:return a=b.find(".ui-em_timepicker-selected"),a.length?a.is(":first-child")||(a.removeClass("ui-em_timepicker-selected"),a.prev().addClass("ui-em_timepicker-selected"),a.prev().position().top<a.outerHeight()&&b.scrollTop(b.scrollTop()-a.outerHeight())):(b.find("li").each(function(c,b){if(d(b).position().top>0)return a=d(b),!1}),a.addClass("ui-em_timepicker-selected")),!1;case 40:return a=b.find(".ui-em_timepicker-selected"),a.length===0?(b.find("li").each(function(c,b){if(d(b).position().top>0)return a=d(b),!1}),a.addClass("ui-em_timepicker-selected")):a.is(":last-child")||(a.removeClass("ui-em_timepicker-selected"),a.next().addClass("ui-em_timepicker-selected"),a.next().position().top+2*a.outerHeight()>b.outerHeight()&&b.scrollTop(b.scrollTop()+a.outerHeight())),!1;case 27:b.find("li").removeClass("ui-em_timepicker-selected"),e.hideMe();break;case 9:e.hideMe();break;default:return!0}}d.fn.em_timepicker=function(a){if(!this.length)return this;if(g[a])return this.hasClass("ui-em_timepicker-input")?g[a].apply(this,Array.prototype.slice.call(arguments,1)):this;if(b(a)==="object"||!a)return g.init.apply(this,arguments);d.error("Method "+a+" does not exist on jQuery.em_timepicker")},d.fn.em_timepicker.defaults=e})})()